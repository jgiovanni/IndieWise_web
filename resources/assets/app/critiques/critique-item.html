<div class="media-object stack-for-small">
    <div class="media-object-section comment-img text-center">
        <div class="comment-box-img">
            <a ui-sref="user.about({url_id: $ctrl.critique.user.url_id})">
                <img ng-src="{{::$ctrl.critique.user.avatar||'/assets/img/avatar-1.png'}}" alt="comment">
            </a>
        </div>
    </div>
    <div class="media-object-section comment-desc">
        <div class="comment-title">
            <span class="name"><a ui-sref="user.about({url_id: $ctrl.critique.user.url_id})">
                {{::$ctrl.critique.user.fullName}}</a> Said:
            </span>
            <span class="time float-right"><i class="fa fa-clock-o"></i>
                <abbr title="{{::$ctrl.critique.created_at|amUtc|amLocal|amDateFormat:'lll'}}"
                      am-time-ago="::$ctrl.critique.created_at"></abbr>

                <!--<span ng-if="$ctrl.critique.editedAt && !Body.isSame(critique.created_at, $ctrl.critique.editedAt)">
                    |Edited: <abbr title="{{::$ctrl.critique.editedAt|amUtc|amLocal|amDateFormat:'lll'}}"
                                   am-time-ago="::$ctrl.critique.editedAt"></abbr>
                </span>-->
            </span>
        </div>
        <div class="comment-text">
            <div class="row clearfix">
                <div class="columns medium-7 small-5">
                    <p ng-bind="::$ctrl.critique.body"></p>
                </div>
                <div class="columns medium-5 small-7">
                    <div class="row" ng-if="::$ctrl.isPrivate() && !$ctrl.isOwnerOrAuthor()">
                        <h3 class="text-center">Private</h3>

                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Overall Rating</span>
                            </div>
                            <div class="columns medium-4 small-3">
                                <span class="md-body-2">{{::$ctrl.critique.overall|number:1}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="row columns" ng-if="::(!$ctrl.isPrivate() || $ctrl.isOwnerOrAuthor()) && $ctrl.critique.type === 'video'">
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Acting</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.performances}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Cinematography</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.cinematography}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Direction</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.direction}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Editing</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.structure}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Music</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.music}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Originality</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.originality}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Pacing</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.pacing}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Production Value</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.production}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Sound Quality</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.audio}}</span>
                        </div>
                        <div class="row columns" style="border-bottom: 1px solid #ddd;">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Writing</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.writing}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Overall Rating</span>
                            </div>
                            <div class="columns medium-4 small-3">
                                <span class="md-body-2">{{::$ctrl.critique.overall|number:1}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="row columns" ng-if="::(!$ctrl.isPrivate() || $ctrl.isOwnerOrAuthor()) && $ctrl.critique.type === 'script'">
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Concept</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.concept}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Presentation</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.presentation}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Characters</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.characters}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Structure</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.structure}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Dialogue</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.dialogue}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Originality</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.originality}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Pacing</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.pacing}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Theme</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.theme}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Style</span>
                            </div>
                            <span class="columns medium-4 small-3" >{{::$ctrl.critique.style}}</span>
                        </div>
                        <div class="row columns" style="border-bottom: 1px solid #ddd;">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Plot</span>
                            </div>
                            <span class="columns medium-4 small-3">{{::$ctrl.critique.writing}}</span>
                        </div>
                        <div class="row columns">
                            <div class="columns medium-8 small-9 text-right">
                                <span class="md-body-1">Overall Rating</span>
                            </div>
                            <div class="columns medium-4 small-3">
                                <span class="md-body-2">{{::$ctrl.critique.overall|number:1}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="comment-btns">
            <span>{{$ctrl.critique.comments_count||0}} comments
                &nbsp;
                <a ng-click="$ctrl.showQuickReply =! $ctrl.showQuickReply"><i class="fa fa-comment"></i> Quick Reply</a>
                &nbsp;
                <a ng-click="$ctrl.view($event)"><i class="fa fa-eye"></i> View</a>
            </span>
            <span><a ui-sref="video_critique({video_url_id: $ctrl.parentUrlId, url_id: $ctrl.critique.url_id})"><i class="fa fa-link"></i> Permalink</a></span>
            <span ng-if="::$ctrl.isPrivate()" class="has-tip" style="margin-right: 0" tooltip="Private"><i class="fa fa-lock"></i></span>
            <span ng-if="$ctrl.critique.user_id === $ctrl.isLoggedIn.id">
                <a ui-sref="video_critique-edit({video_url_id: $ctrl.parentUrlId, url_id: $ctrl.critique.url_id})"><i class="fa fa-pencil"></i> Edit</a>
            </span>
            <!--<span ng-if="$ctrl.critique.user_id === isLoggedIn.id">
                <a ng-click="$ctrl.critique.deleteCritique(critique, $event)"><i class="fa fa-close"></i>Delete</a>
            </span>-->
        </div>

    </div>


    <div class="media-object stack-for-small reply-comment">
        <div class="media-object stack-for-small" ng-repeat="comment in $ctrl.critique.comments.data"
             ng-init="comment.replies=[];comment.showReplies=false;">
            <div class="media-object-section comment-img text-center">
                <div class="comment-box-img">
                    <a ui-sref="user.about({url_id: comment.author.url_id})"><img ng-src="{{::comment.author.avatar || '/assets/img/avatar-1.png'}}" alt="comment"></a>
                </div>
            </div>
            <div class="media-object-section comment-desc">
                <div class="comment-title">
                    <span class="name"><a ui-sref="user.about({url_id: comment.author.url_id})">
                        {{::comment.author.fullName}}</a> Said:
                    </span>
                    <span class="time float-right">
                        <i class="fa fa-clock-o"></i>
                        <abbr title="{{::comment.created_at|amUtc|amLocal|amDateFormat:'lll'}}"
                              am-time-ago="::comment.created_at"></abbr>
                    </span>
                </div>
                <div class="comment-text">
                    <p ng-bind="comment.body"></p>
                </div>
                <div class="comment-btns">
                                    <span>
                                        <!--<a href="#"><i class="fa fa-thumbs-o-up"></i></a> |-->
                                        <!--<a href="#"><i class="fa fa-thumbs-o-down"></i></a> |-->
                                        {{comment.replies_count||0}}&nbsp;<i class="fa fa-comments"></i>
                                    </span>
                    <!--<span><a ng-click="toggleReplyInput(comment)"><i class="fa fa-share"></i>Reply</a></span>-->
                    <span toggle-replies ng-if="comment.replies_count" class='reply float-right'>
                                        Show replies <i class="fa fa-angle-down"></i>
                                    </span>
                </div>

                <reply target-comment="comment" parent="$ctrl.critique"
                       ng-if="!!$ctrl.showReplyInput && $ctrl.targetComment == comment"></reply>

                <!--sub comment-->
                <div class="media-object stack-for-small reply-comment" ng-repeat-start="reply in comment.replies">
                    <div class="media-object-section comment-img text-center">
                        <div class="comment-box-img">
                            <img ng-src="{{::reply.author.avatar || '/assets/img/avatar-1.png'}}"
                                 alt="comment">
                        </div>
                    </div>
                    <div class="media-object-section comment-desc">
                        <div class="comment-title">
                            <span class="name"><a ui-sref="user.about({url_id: reply.author.urlId})">{{::reply.author.fullName}}</a> Said:</span>
                            <span class="time float-right"><i class="fa fa-clock-o"></i>
                                        <abbr title="{{::reply.created_at|amUtc|amLocal|amDateFormat:'lll'}}" am-time-ago="::reply.created_at"></abbr>
                                    </span>
                        </div>
                        <div class="comment-text">
                            <p ng-show="editComment.id!=reply.id" ng-bind="reply.body"></p>
                            <edit-comment-block
                                    ng-if="reply.author === model.isLoggedIn.id && !!editCommentMode"></edit-comment-block>
                        </div>
                        <div class="comment-btns">
                                    <span>
                                        <a href="#"><i class="fa fa-thumbs-o-up"></i></a> |
                                        <a href="#"><i class="fa fa-thumbs-o-down"></i></a>
                                    </span>
                            <span><a ng-click="$ctrl.toggleReplyInput(reply)"><i
                                    class="fa fa-share"></i>Reply</a></span>
                            <!--<span toggle-replies class='reply float-right'></span>-->
                        </div>
                    </div>
                </div>
                <reply flex="95" ng-repeat-end target-comment="targetComment" parent="commentsParent"
                       ng-if="!!$ctrl.showReplyInput && targetComment == reply"></reply>
                <!-- end sub comment -->

            </div>
        </div>
        <reply parent="$ctrl.critique" ng-show="$ctrl.showQuickReply"></reply>
    </div>
</div>