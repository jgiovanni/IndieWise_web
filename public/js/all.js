function loadScript(e,t){var n=document.createElement("script");n.type="text/javascript",n.onload=function(){t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}jQuery.noConflict(),jQuery(document).foundation(),jQuery(document).ready(function(e){"use strict";e(".loginReg").on("click",function(t){t.preventDefault(),e(this).next().slideToggle(),e(this).toggleClass("active")}),e(".search.end").on("click",function(){e(this).children().hasClass("fa-search")?(e(this).children().removeClass("fa-search"),e(this).children().addClass("fa-times")):(e(this).children().removeClass("fa-times"),e(this).children().addClass("fa-search")),e(this).toggleClass("search-active"),e("#search-bar").slideToggle()});var t="#back-to-top";if(e(t).length){var n=100,i=function(){var i=e(window).scrollTop();i>n?e(t).addClass("show"):e(t).removeClass("show")};i(),e(window).on("scroll",function(){i()}),e("#back-to-top").on("click",function(t){t.preventDefault(),e("html,body").animate({scrollTop:0},700)})}e("div.social-login").mouseenter(function(){e("i.arrow-left").addClass("active")}).mouseleave(function(){e("i.arrow-left").removeClass("active")}),e("div.register-form").mouseenter(function(){e("i.arrow-right").addClass("active")}).mouseleave(function(){e("i.arrow-right").removeClass("active")});var o=e(".thumb-slider .thumbs").find(".ver-thumbnail");e(o).on("click",function(){var t=e(this).attr("id");e(".image").eq(0).show(),e(".image").hide(),e(".image").hide(),e("."+t).fadeIn()});var r=e(".thumb-slider .thumbs .thumbnails").scrollTop(0);e(".thumb-slider .thumbs a").click(function(t){t.preventDefault();var n=e(this).hasClass("down")?"+=200":"-=200";r.animate({scrollTop:n})})}),function(){"use strict";angular.module("underscore",[]).factory("_",function(){return window.___}),angular.module("IndieWise",["templates","ngIntercom","ngMaterial","mm.foundation","angucomplete-alt","ngMessages","ngResource","ngWebSocket","angular-cloudinary","underscore","angularMoment","videosharing-embed","angular-loading-bar","LocalForageModule","ui.router","angular-google-analytics","ui.scroll","ui.scroll.jqlite","ngFileUpload","satellizer","angular-filepicker","pascalprecht.translate","720kb.socialshare","ngAnimate-animate.css","IndieWise.controllers","IndieWise.services","IndieWise.directives","IndieWise.filters","IndieWise.utilities","IndieWise.winners"]).constant("moment",window.momentTimeZone).constant("angularMomentConfig",{timezone:"UTC"}).constant("API",window.API||"/api/").constant("BASE",window.BASE||BASE+"public/").constant("INTERCOM_APPID","ppp65byn").config(["$authProvider",function(e){e.loginUrl="/api/login",e.signupUrl="/api/register",e.facebook({clientId:"150687055270744"}),e.google({clientId:"322274582930-4m1dueb708gvdic28n12e5dhqq121a6b.apps.googleusercontent.com"}),e.twitter({clientId:"nnSvvHd86gBpxPwJaLGvzM2Mm"})}]).config(["$intercomProvider","INTERCOM_APPID",function(e,t){e.appID(t),e.asyncLoading(!0)}]).config(["filepickerProvider",function(e){e.setKey("APbjTx44SlSuCI6P58jwvz")}]).config(["cloudinaryProvider",function(e){e.config({upload_endpoint:"https://api.cloudinary.com/v1_1/",cloud_name:"indiewise",upload_preset:"r0kuyqef"})}]).config(["$compileProvider",function(e){e.debugInfoEnabled(!1)}]).config(["AnalyticsProvider",function(e){e.setAccount("UA-27155404-17")}]).config(["$httpProvider",function(e){e.interceptors.push("authInterceptor")}]).factory("authInterceptor",["$q","$injector","$location","API",function(e,t,n,i){return{request:function(e){return e.headers=e.headers||{},e},response:function(e){return e},responseError:function(t){if(401===t.status||403===t.status);else if(500==t.status&&t.config.url.indexOf("http")===-1&&t.config.url.indexOf("/api")>-1){var n=e.defer();return n.promise}return t}}}]).config(["$mdThemingProvider","$mdIconProvider","BASE",function(e,t,n){e.theme("default").primaryPalette("grey").accentPalette("indigo"),t.icon("emotion",n+"assets/svg/emotion.svg",120).icon("angry",n+"assets/svg/emoticons/angry.svg",120).icon("annoyed",n+"assets/svg/emoticons/annoyed.svg",120).icon("big-smile",n+"assets/svg/emoticons/big-smile.svg",120).icon("bored",n+"assets/svg/emoticons/bored.svg",120).icon("confused",n+"assets/svg/emoticons/confused.svg",120).icon("crying",n+"assets/svg/emoticons/crying.svg",120).icon("disappointed",n+"assets/svg/emoticons/disappointed.svg",120).icon("emotional",n+"assets/svg/emoticons/emotional.svg",120).icon("grinning",n+"assets/svg/emoticons/grinning.svg",120).icon("happy",n+"assets/svg/emoticons/happy.svg",120).icon("hehe",n+"assets/svg/emoticons/hehe.svg",120).icon("hopeful",n+"assets/svg/emoticons/hopeful.svg",120).icon("interested",n+"assets/svg/emoticons/interested.svg",120).icon("joking",n+"assets/svg/emoticons/joking.svg",120).icon("kiss",n+"assets/svg/emoticons/kiss.svg",120).icon("love",n+"assets/svg/emoticons/love.svg",120).icon("mad",n+"assets/svg/emoticons/mad.svg",120).icon("meh",n+"assets/svg/emoticons/meh.svg",120).icon("mute",n+"assets/svg/emoticons/mute.svg",120).icon("nerdy",n+"assets/svg/emoticons/nerdy.svg",120).icon("neutral",n+"assets/svg/emoticons/neutral.svg",120).icon("ninja",n+"assets/svg/emoticons/ninja.svg",120).icon("nostalgic",n+"assets/svg/emoticons/nostalgic.svg",120).icon("oh-really",n+"assets/svg/emoticons/oh-really.svg",120).icon("sad",n+"assets/svg/emoticons/sad.svg",120).icon("sad-tear",n+"assets/svg/emoticons/sad-tear.svg",120).icon("sarcastic",n+"assets/svg/emoticons/sarcastic.svg",120).icon("sexy",n+"assets/svg/emoticons/sexy.svg",120).icon("shocked",n+"assets/svg/emoticons/shocked.svg",120).icon("silent",n+"assets/svg/emoticons/silent.svg",120).icon("silly",n+"assets/svg/emoticons/silly.svg",120).icon("smile",n+"assets/svg/emoticons/smile.svg",120).icon("sympathetic",n+"assets/svg/emoticons/sympathetic.svg",120).icon("wink",n+"assets/svg/emoticons/wink.svg",120).icon("woah",n+"assets/svg/emoticons/woah.svg",120).icon("matureSmall",n+"assets/svg/OFLC_small_M.svg",120).icon("matureSmall",n+"assets/svg/OFLC_small_M.svg",120).icon("trophy",n+"assets/svg/trophy.svg",120).icon("matureLarge",n+"assets/svg/OFLC_large_M.svg",120)}]).config(["$stateProvider","$urlRouterProvider","$locationProvider","BASE",function(e,t,n,i){t.when("","/home"),t.when("/","/home"),e.state("home",{url:"/home",authenticate:!1,templateUrl:"home/view/index.html",controller:"HomeCtrl as Home"}).state("browse",{url:"/browse?q&sort&types&genres",authenticate:!1,templateUrl:"browse/view/index.html",controller:"BrowseCtrl as Browse"}).state("latest",{url:"/latest",authenticate:!1,templateUrl:"latest/view/index.html",controller:"LatestCtrl as LC"}).state("winners",{url:"/winners",authenticate:!1,templateUrl:"winners/index.html",controller:"WinnersCtrl as WC"}).state("video_critique",{url:"/{video_url_id}/critique/{url_id}",authenticate:!1,templateUrl:"common/critique.html",controller:"VideoCritiqueCtrl as VCC",resolve:{Critique:["$stateParams","DataService",function(e,t){return t.item("critiques",e.url_id,"project.owner").then(function(e){return e})}]}}).state("video_critique-edit",{url:"/{video_url_id}/critique/{url_id}/edit",authenticate:!0,templateUrl:"common/critique-edit.html",controller:"VideoCritiqueEditCtrl",resolve:{Critique:["AuthService","$stateParams","DataService",function(e,t,n){return n.item("critiques",t.url_id,"project.owner").then(function(t){return e.isAuthenticated()&&t.data.data.user_id===e.currentUser.id?t:"Not Owner"})}]}}).state("user",{url:"/user/{url_id}",authenticate:!0,"abstract":!0,templateUrl:"auth/user.html",controller:"UserCtrl as UserC",resolve:{User:["$stateParams","DataService",function(e,t){return t.item("users",e.url_id).then(function(e){return e.data.data})}],UserStats:["User","DataService",function(e,t){return t.item("users/countUserStats",e.id).then(function(e){return e.data})}]}}).state("user.about",{url:"/about",templateUrl:"auth/user-about.html",controller:"UserAboutController as UserAboutCtrl"}).state("user.videos",{url:"/videos",templateUrl:"auth/user-videos.html",controller:"UserVideosController as UserVideosCtrl",resolve:{Videos:["User","DataService","$q",function(e,t,n){return t.collection("projects",{owner:e.id,sort:"created_at",per_page:50}).then(function(e){return e})}]}}).state("user.critiques",{url:"/critiques",templateUrl:"auth/user-critiques.html",controller:"UserCritiquesController as UserCritiquesCtrl",resolve:{Critiques:["User","DataService",function(e,t){return t.collection("critiques",{user:e.id,include:"project"}).then(function(e){return e})}],Critiqued:["User","DataService",function(e,t){return t.collection("critiques",{notUser:e.id,include:"project"}).then(function(e){return e})}]}}).state("user.reactions",{url:"/reactions",templateUrl:"auth/user-reactions.html",controller:"UserReactionsController as UserReactionsCtrl",resolve:{Reactions:["User","DataService",function(e,t){return t.collection("reactions",{user:e.id,include:"user,project"}).then(function(e){return e})}],Reacted:["User","DataService",function(e,t){return t.collection("reactions",{notUser:e.id,include:"user,project"}).then(function(e){return e})}]}}).state("user.awards",{url:"/awards",templateUrl:"auth/user-awards.html",controller:"UserAwardsController as UserAwardsCtrl",resolve:{Awards:["User","DataService",function(e,t){return t.collection("wins",{user:e.id}).then(function(e){return e})}],Nominations:["User","DataService",function(e,t){return t.collection("nominations",{user:e.id,include:"user,project,award"}).then(function(e){return e})}],Nominated:["User","DataService",function(e,t){return t.collection("nominations",{notUser:e.id,include:"user,project,award"}).then(function(e){return e})}]}}).state("profile",{url:"/profile",authenticate:!0,"abstract":!0,templateUrl:"auth/profile.html",controller:"ProfileCtrl as Profile",resolve:{User:["AuthService","DataService",function(e,t){return t.item("users",e.currentUser.id,{include:"genres"}).then(function(e){return e.data.data})}],UserStats:["AuthService","DataService",function(e,t){return t.collection("users/countUserStats").then(function(e){return e.data})}]}}).state("profile.about",{url:"/about",authenticate:!0,templateUrl:"auth/profile-about.html",controller:"ProfileAboutController as ProfileAboutCtrl"}).state("profile.upload",{url:"/upload",authenticate:!0,templateUrl:"auth/profile-upload.html",controller:"ProfileUploadController as UC",resolve:{Access:["$rootScope","DataService","AuthService","$q",function(e,t,n,i){var o=i.defer();return e.isNotVerified()?(e.toastAction("Please verify your account so you can upload videos! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),o.reject(!1)):t.collection("projects/limit").then(function(t){t.data.status?o.resolve(!0):(e.toastMessage("Your upload limit of 3 has been reached"),o.reject(!1))}),o.promise}]}}).state("profile.videos",{url:"/videos",authenticate:!0,templateUrl:"auth/profile-videos.html",controller:"ProfileVideosController as ProfileVideosCtrl",resolve:{Videos:["AuthService","DataService",function(e,t){return t.collection("projects",{owner:e.currentUser.id,sort:"created_at",per_page:50}).then(function(e){return e})}]}}).state("profile.videos-edit",{url:"/videos/{url_id}/edit",authenticate:!0,templateUrl:"auth/profile-videos-edit.html",controller:"ProfileVideoEditCtrl as VEC",resolve:{Project:["AuthService","$stateParams","DataService",function(e,t,n){return n.item("projects",t.url_id).then(function(e){return e})}]}}).state("profile.critiques",{url:"/critiques",authenticate:!0,templateUrl:"auth/profile-critiques.html",controller:"ProfileCritiquesController as ProfileCritiquesCtrl",resolve:{Critiques:["AuthService","DataService",function(e,t){return t.collection("critiques",{user:e.currentUser.id}).then(function(e){return e})}],Critiqued:["AuthService","DataService",function(e,t){return t.collection("critiques",{notUser:e.currentUser.id}).then(function(e){return e})}]}}).state("profile.reactions",{url:"/reactions",authenticate:!0,templateUrl:"auth/profile-reactions.html",controller:"ProfileReactionsController as ProfileReactionsCtrl",resolve:{Reactions:["AuthService","DataService",function(e,t){return t.collection("reactions",{user:e.currentUser.id,include:"user,project"}).then(function(e){return e})}],Reacted:["AuthService","DataService",function(e,t){return t.collection("reactions",{notUser:e.currentUser.id,include:"user,project"}).then(function(e){return e})}]}}).state("profile.awards",{url:"/awards",authenticate:!0,templateUrl:"auth/profile-awards.html",controller:"ProfileAwardsController as ProfileAwardsCtrl",resolve:{Awards:["AuthService","DataService",function(e,t){return t.collection("wins",{user:e.currentUser.id}).then(function(e){return e})}],Nominations:["AuthService","DataService",function(e,t){return t.collection("nominations",{user:e.currentUser.id,include:"user,project,award"}).then(function(e){return e})}],Nominated:["AuthService","DataService",function(e,t){return t.collection("nominations",{notUser:e.currentUser.id,include:"user,project,award"}).then(function(e){return e})}]}}).state("profile.playlists",{url:"/playlists",authenticate:!0,templateUrl:"auth/profile-playlists.html",controller:"ProfilePlaylistsController as ProfilePlaylistsCtrl",resolve:{Playlists:["AuthService","DataService",function(e,t){return t.collection("playlists").then(function(e){return e})}]}}).state("profile.settings",{url:"/settings",authenticate:!0,templateUrl:"auth/profile-settings.html",controller:"ProfileSettingsController as PSC",resolve:{Genres:["AuthService","DataService","$q",function(e,t,n){return t.collection("genres",[],[{fieldName:"user",operator:"in",value:e.currentUser.id}],20,!1,!1,1).then(function(e){return e})}],UserTypes:["AuthService","DataService","$q",function(e,t,n){return t.collection("types",[],[{fieldName:"user",operator:"in",value:e.currentUser.id}],20,!1,!1,1).then(function(e){return e})}]}}).state("messages",{url:"/messages",authenticate:!0,templateUrl:"auth/messages.html",controller:"MessagesCtrl as Msgs",resolve:{Conversations:["AuthService","DataService","$q",function(e,t,n){return t.collection("messages").then(function(e){return e})}]}}).state("messages.message",{authenticate:!0,templateUrl:"auth/messages.html",controller:"MessagesCtrl as Msgs"}).state("register",{url:"/register",authenticate:!1,templateUrl:"auth/register.html",controller:"RegisterCtrl as RC"}).state("sign_in",{url:"/sign-in",authenticate:!1,templateUrl:"auth/sign-in.html",controller:"SignInCtrl as SIC"}).state("reset_password",{url:"/reset-password?email&token",authenticate:!1,templateUrl:"auth/reset-password.html",controller:"ForgotPasswordCtrl as FPC"}).state("about",{url:"/about",authenticate:!1,templateUrl:"static/about.html"}).state("faq",{url:"/faq",authenticate:!1,templateUrl:"static/faq.html"}).state("contact",{url:"/contact?email",authenticate:!1,templateUrl:"static/contact.html",controller:"ContactPageCtrl as CC"}).state("tos",{url:"/terms-of-service",authenticate:!1,templateUrl:"static/tos.html"}).state("advertise",{url:"/advertise",authenticate:!1,templateUrl:"static/advertise.html"}).state("privacy",{url:"/privacy-policy",authenticate:!1,templateUrl:"static/privacy.html"}).state("404",{url:"/404",authenticate:!1,templateUrl:"static/404.html"}).state("video",{url:"/{url_id:[0-9a-zA-Z]{1,13}}",authenticate:!1,templateUrl:"common/video.html",controller:"VideoCtrl as VC",resolve:{Project:["$stateParams","DataService","$q",function(e,t,n){var i=n.defer();return t.item("projects",e.url_id,"").then(function(e){i.resolve(e.data.data)})["catch"](function(e){i.reject(e)}),i.promise}]}}),t.otherwise("/404"),n.html5Mode(!0)}]).config(["$transitionsProvider",function(e){e.onError({},function(e){e.promise["catch"](function(e){console.error(e)})})}]).constant("StreamConfig",{streamApiKey:"97wfnrargt9f",streamApiSecret:"4t8dpp9bsap2svjhvu2n4x3h3bvwyyb3kgvg7san3bab2esu6vmnquffq2u95z82",streamApp:"6408"}).run(["$rootScope","$state","$stateParams","AuthService","UtilsService","DataService","$http","$timeout","$transitions","StreamConfig","anchorSmoothScroll","amMoment","$intercom","socket",function(e,t,n,i,o,r,a,s,c,l,u,d,m,p){attachFastClick(document.body),e.AppData={User:i.currentUser,Notifications:{loaded:"indeterminate"},NotificationsFeed:{loaded:"indeterminate"},MessageNotifications:{loaded:"indeterminate"},searchText:""},e.$state=window.thisState=t,e.metadata={title:"",description:"",image:"",url:""},e.$stateParams=n,e.isViewLoading=!1,e.today=moment().toDate(),e.isAuthenticated=function(){return i.isAuthenticated()},e.isVerified=function(){return i.isAuthenticated()&&angular.isObject(e.AppData.User)&&1===e.AppData.User.verified},e.isNotVerified=function(){return i.isAuthenticated()&&angular.isObject(e.AppData.User)&&0===e.AppData.User.verified},e.listenNotifications=function(t){e.refreshNotifications(t)},e.refreshNotifications=function(t){e.AppData.Notifications.loaded="indeterminate",r.collection("getUserNotifications",{username:t}).then(function(t){console.log(t.data),e.AppData.Notifications={loaded:"",list:t.data,unseen:_.where(t.data,{seen:!1}).length,unread:0},console.log(e.AppData.Notifications)})},e.StreamClient=stream.connect(l.streamApiKey,null,l.streamApp,{location:"us-east"}),e.getNewToken=function(e,t){return a.get("/api/notifications/token?type="+e).then(function(e){return e.data.token})},e.getMessagesFeed=function(t){t.get({limit:10},function(t,n,i){console.log("Messages Notifications: ",i);try{e.AppData.MessageNotifications={loaded:"",list:i.results,unseen:i.unseen,unread:i.unread},console.log(e.AppData.MessageNotifications)}catch(o){console.log(o)}})},e.subscribeUserFeeds=function(){e.getNewToken("notification",e.AppData.User.id).then(function(t){var n=e.StreamClient.feed("notification",e.AppData.User.id,t);n.subscribe(function(t){console.log("Notification: ",t),e.getNotificationsFeed(n)}).then(function(){e.getNotificationsFeed(n)})}),e.getNewToken("message",e.AppData.User.id).then(function(t){var n=e.StreamClient.feed("message",e.AppData.User.id,t);n.subscribe(function(t){console.log("Messages: ",t),e.getMessagesFeed(n)}).then(function(){e.getMessagesFeed(n)})})},e.getNotificationsFeed=function(t){a.get("/api/notifications/feed").then(function(t){console.log("Notification: ",t.data.activities),e.AppData.Notifications={loaded:"",list:t.data.activities,unseen:t.data.unseen,unread:t.data.unread}})},e.getNewMessages=function(){},m.$on("show",function(){e.intercomShowing=!0}),m.$on("hide",function(){e.intercomShowing=!1});var f=e.$watch("AppData.User",function(t,n){if(t&&angular.isString(t.id)){console.log("User Logged In"),t.name=t.fullName,m.boot(t);var o=window.OneSignal||[];o.push(["init",{appId:"9972c4b2-7bd1-47c0-a2f8-213b8c767cd8",safari_web_id:"web.onesignal.auto.3f58661c-f8ad-4946-a9b6-84125eec4421",autoRegister:!0,notifyButton:{enable:!1}}]),t.push_id||o.getUserId().then(function(e){i.updateUser({id:t.id,push_id:e})}),e.subscribeUserFeeds(),e.getNewMessages(),f()}});e.setLoading=function(){e.isViewLoading=!0},e.unsetLoading=function(){e.isViewLoading=!1},c.onBefore({},function(t){e.setLoading()}),c.onStart({to:"register",from:"*"},function(e){return!i.isAuthenticated()||t.target("home")}),c.onStart({to:"sign_in",from:"*"},function(e){return!i.isAuthenticated()||t.target("home")}),c.onStart({to:"reset_password",from:"*"},function(e){return!i.isAuthenticated()||t.target("home")}),c.onStart({to:function(e){return!!e.authenticate}},function(e){return!!i.currentUser||i.getCurrentUser().then(function(){return!0},function(){return t.target("sign_in")})}),c.onSuccess({},function(){e.unsetLoading(),s(function(){jQuery(document).foundation(),u.scrollTo("body")},100)}),c.onError({},function(e){console.log(t)}),t.defaultErrorHandler(function(e){})}]).config(["$localForageProvider",function(e){e.config({name:"iw",version:1,storeName:"keyvaluepairs",description:"some description"})}]).config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self","https://getindiewise.com/**","https://www.getindiewise.com/**",new RegExp("^(http[s]?)://(w{3}.)?youtube.com/.+$")])}])}(),function(){"use strict";function e(e){return e.replace(/[\0\x08\x09\x1a\n\r"'\\\%]/g,function(e){switch(e){case"\0":return"\\0";case"\b":return"\\b";case"\t":return"\\t";case"":return"\\z";case"\n":return"\\n";case"\r":return"\\r";case'"':case"'":case"\\":case"%":return"\\"+e}})}function t(t,n,i,o,r,a,s,c){t.metadata.title="Register";var l=this;l.creating=!1,l.accountCreated=!1,l.genresArr=[],l.typesArr=[],l.user={email:"",password:"",passwordCheck:"",firstName:"",lastName:"",gender:""},l.dobDay="",l.dobMonth="",l.dobYear="",l.authErrors=null,l.errors={email:!1,gender:!1,genres:!1,types:!1},l.thisYear=moment().year(),l.yearsList=[];for(var u=l.thisYear;u>l.thisYear-100;u--)l.yearsList.push(u);t.generateCountries().then(function(e){t.countryList=l.countryList=e}),l.checkEmailUse=function(){angular.isString(l.user.email)&&l.user.email.length?a.collection("emailCheck",{email:e(l.user.email)}).then(function(e){l.errors.email=e.data&&e.data.verify===!0?1:0}):l.errors.email=!1},l.doRegister=function(){if(l.creating)t.toastMessage("Please wait...");else{if(l.creating=!0,l.errors.gender=!l.user.gender.length,l.errors.gender)return s.scrollTo("errors"),!1;l.user.dob=moment().set({year:l.dobYear,month:parseInt(l.dobMonth)-1,date:l.dobDay}).startOf("day").format("YYYY-MM-DD HH:mm:ss"),r.createUser(l.user).then(function(e){e.status?t.toastMessage("Account created!"):(l.authErrors=e.errors,t.toastMessage("There is an error, please check your form")),l.creating=!1})}},l.authenticate=function(e){l.error=null,r.socialLogin(e,!0).then(function(e){e&&o.go("profile.about",{reload:!0})})},n(function(){jQuery(document).foundation(),n(function(){jQuery(document).foundation()},500)},500)}function n(e,t,n,i,o,r,a){e.metadata.title="Sign In";var s=this;s.authErrors=null,s.user={email:"",password:""},s.doLogin=function(e){e=e||!0,s.error=!1,o.login(s.user.email,s.user.password).then(function(t){return t.status===!1?(s.authErrors=t.errors,!1):(e&&angular.isDefined(t)&&i.go("home"),void a.complete())},function(e){s.error=e})},s.authenticate=function(t){s.error=null,o.socialLogin(t,!1).then(function(t){t.status||(s.authErrors=t.errors,e.toastMessage("There is an error, please check your form"))})},t(function(){jQuery(document).foundation(),t(function(){jQuery(document).foundation()},500)},500)}function i(e,t,n){e.metadata.title="Password Recovery";var i=this;i.email="",i.reseting={newPassword:null,newPasswordCheck:null},i.hasToken=e.$stateParams.token||!1,i.doPasswordResetRequest=function(){n.requestPasswordReset(i.email).then(function(n){e.toastMessage("Check your inbox for our email! Should be there soon."),t.go("sign_in")},function(t){e.toastMessage("Error: "+t.message)})},i.confirmReset=function(){return!(i.reseting.newPassword!==i.reseting.newPasswordCheck||!angular.isString(i.hasToken))&&void n.passwordReset(e.$stateParams.email,i.reseting.newPassword,i.reseting.newPasswordCheck,i.hasToken).then(function(e){})},i.hasToken}function o(e,t,n,i,o,r,a,s,c,l,u,d){function m(e){d(e).toggle().then(function(){})}function p(e){d(e).close().then(function(){})}function f(e){return a.favorite(e)}function h(e){return a.watchLater(e)}function g(e,t){return l.contains(e,t)}function v(e,t){return moment(e).isSame(t,"hour")}function y(t){c.notifyMe(t).then(function(t){if("success"==t.data.status)return e.toastMessage("Thanks for joining our newsletter!"),w.notifyMe={}},function(e){})}var w=this;w.selected=null,e.AppData.searchText=decodeURIComponent(e.$stateParams.q||""),w.selectedItem="",w.notificationsTemplate=s.trustAsResourceUrl("src/directives/notification.html"),w.newsletterRegister=y,c.collection("projects",{per_page:3,sort:"created_at"}).then(function(e){l.each(e.data.data,function(e){}),w.footerRecentVideos=e.data}),w.startSearch=function(e){e&&w.toPage("browse",{q:e})};var A=function(){return!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))},C=function(){return!!navigator.userAgent.match(/Android/i)};e.isMobile=w.isMobile=function(){return A()||C()||"small"===Foundation.MediaQuery.current},e.requestVerificationEmail=function(){o.requestVerification().then(function(){w.verificationEmailSentMessage=!0})},e.generateGenres=function(){var i=n.defer();return t.getItem("genres",!0).then(function(t){e.genresList=t,i.resolve(t)},function(n){c.collection("genres").then(function(n){e.genresList=n.data.Genres,t.setItem("genres",n.data.Genres),i.resolve(n.data.Genres)})}),i.promise},e.generateTypes=function(){var i=n.defer();return t.getItem("types",!0).then(function(t){e.typesList=t,i.resolve(t)},function(n){c.collection("types").then(function(n){e.typesList=n.data.Types,t.setItem("types",n.data.Types),i.resolve(n.data.Types)})}),i.promise},e.generateCountries=function(){var i=n.defer();return t.getItem("countries",!0).then(function(t){e.countryList=t,i.resolve(t)},function(n){c.collection("countries").then(function(n){e.countryList=n.data.Countries,t.setItem("countries",n.data.Countries),i.resolve(n.data.Countries)})}),i.promise},e.generateLanguages=function(){var i=n.defer();return t.getItem("languages",!0).then(function(t){e.languageList=t,i.resolve(t)},function(n){c.collection("languages").then(function(n){e.languageList=n.data.Languages,t.setItem("languages",n.data.Languages),i.resolve(n.data.Languages)})}),i.promise},e.generateReactions=function(){return[{name:"Happy",emotion:"happy",icon:"happy"},{name:"Sad",emotion:"sad",icon:"sad"},{name:"Offended",emotion:"offended",icon:"annoyed"},{name:"Amused",emotion:"amused",icon:"grinning"},{name:"Mad",emotion:"mad",icon:"mad"},{name:"Furious",emotion:"furious",icon:"angry"},{name:"Awesome",emotion:"awesome",icon:"woah"},{name:"Terrified",emotion:"terrified",icon:"shocked"},{name:"Confused",emotion:"confused",icon:"confused"},{name:"In-Love",emotion:"in-love",icon:"love"},{name:"Amazed",emotion:"amazed",icon:"woah"},{name:"Motivated",emotion:"motivated",icon:"interested"},{name:"Inspired",emotion:"inspired",icon:"interested"},{name:"Bored",emotion:"bored",icon:"bored"},{name:"Sleepy",emotion:"sleepy",icon:"bored"},{name:"Emotional",emotion:"emotional",icon:"emotional"},{name:"Excited",emotion:"excited",icon:"big-smile"},{name:"Nostalgic",emotion:"nostalgic",icon:"nostalgic"},{name:"Annoyed",emotion:"annoyed",icon:"annoyed"},{name:"Sorry",emotion:"sorry",icon:"sad-tear"},{name:"Ashamed",emotion:"ashamed",icon:"sad-tear"},{name:"Meh",emotion:"meh",icon:"meh"},{name:"Special",emotion:"special",icon:"wink"},{name:"Sick",emotion:"sick",icon:"mute"},{name:"Great",emotion:"great",icon:"grinning"},{name:"Guilty",emotion:"guilty",icon:"sympathetic"},{name:"Hopeful",emotion:"hopeful",icon:"hopeful"},{name:"Hopeless",emotion:"hopeless",icon:"sad"},{name:"Secure",emotion:"secure",icon:"nerdy"},{name:"Blessed",emotion:"blessed",icon:"grinning"},{name:"Interested",emotion:"interested",icon:"interested"},{name:"Comfortable",emotion:"comfortable",icon:"hehe"},{name:"Disturbed",emotion:"disturbed",icon:"confused"},{name:"Stupid",emotion:"stupid",icon:"confused"},{name:"Sexy",emotion:"sexy",icon:"sexy"},{name:"Relaxed",emotion:"relaxed",icon:"happy"},{name:"Empowered",emotion:"empowered",icon:"happy"},{name:"Cool",emotion:"cool",icon:"happy"},{name:"Pumped",emotion:"pumped",icon:"happy"},{name:"Turned On",emotion:"turned on",icon:"happy"},{name:"Proud",emotion:"Proud",icon:"happy"},{name:"Disgusted",emotion:"disgusted",icon:"annoyed"},{name:"Sympathetic",emotion:"sympathetic",icon:"happy"},{name:"Overwhelmed",emotion:"overwhelmed",icon:"happy"},{name:"Passionate",emotion:"passionate",icon:"happy"},{name:"Thrilled",emotion:"thrilled",icon:"happy"},{name:"Loved",emotion:"loved",icon:"happy"},{name:"Thankful",emotion:"thankful",icon:"happy"},{name:"Appreciated",emotion:"appreciated",icon:"happy"},{name:"Romantic",emotion:"romantic",icon:"love"},{name:"Chill",emotion:"chill",icon:"happy"},{name:"Pissed Off",emotion:"pissed off",icon:"annoyed"},{name:"Accomplished",emotion:"accomplished",icon:"happy"},{name:"Honored",emotion:"honored",icon:"happy"},{name:"Young",emotion:"young",icon:"happy"},{name:"Wild",emotion:"wild",icon:"happy"},{name:"Old",emotion:"old",icon:"happy"},{name:"Free",emotion:"free",icon:"happy"},{name:"Epic",emotion:"epic",icon:"happy"},{name:"Fired Up",emotion:"fired up",icon:"happy"},{name:"Detached",emotion:"detached",icon:"happy"},{name:"Disconnected",emotion:"disconnected",icon:"confused"},{name:"Connected",emotion:"connected",icon:"happy"},{name:"Beautiful",emotion:"beautiful",icon:"happy"},{name:"Confident",emotion:"confident",icon:"happy"},{name:"Positive",emotion:"positive",icon:"happy"},{name:"Negative",emotion:"negative",icon:"annoyed"},{name:"Heartbroken",emotion:"heartbroken",icon:"emotional"},{name:"Silly",emotion:"silly",icon:"hehe"},{name:"Disappointed",emotion:"disappointed",icon:"sad"},{name:"Stressed",emotion:"stressed",icon:"annoyed"},{name:"Fantastic",emotion:"fantastic",icon:"big-smile"},{name:"Hungry",emotion:"hungry",icon:"annoyed"},{name:"Shocked",emotion:"shocked",icon:"shocked"},{name:"Frustrated",emotion:"frustrated",icon:"annoyed"},{name:"Engrossed",emotion:"engrossed",icon:"interested"},{name:"Peaceful",emotion:"peaceful",icon:"happy"},{name:"Surprised",emotion:"surprised",icon:"woah"},{name:"Satisfied",emotion:"satisfied",icon:"happy"},{name:"Incomplete",emotion:"incomplete",icon:"sad"},{name:"Complete",emotion:"complete",icon:"happy"},{name:"Entertained",emotion:"entertained",icon:"hehe"},{name:"Enlightened",emotion:"enlightened",icon:"interested"},{name:"Relieved",emotion:"relieved",icon:"happy"},{name:"Concerned",emotion:"concerned",icon:"sympathetic"},{name:"Strong",emotion:"strong",icon:"happy"},{name:"Optimistic",emotion:"optimistic",icon:"happy"},{name:"Discouraged",emotion:"discouraged",icon:"happy"},{name:"Lucky",emotion:"lucky",icon:"happy"},{name:"Scared",emotion:"scared",icon:"happy"},{name:"Brave",emotion:"brave",icon:"happy"},{name:"Naughty",emotion:"naughty",icon:"sexy"},{name:"Alert",emotion:"alert",icon:"happy"},{name:"Alive",emotion:"alive",icon:"happy"},{name:"Perfect",emotion:"perfect",icon:"happy"},{name:"Nervous",emotion:"nervous",icon:"happy"},{name:"Tense",emotion:"tense",icon:"annoyed"},{name:"Impatient",emotion:"impatient",icon:"annoyed"},{name:"Philosophical",emotion:"philosophical",icon:"interested"},{name:"Empty",emotion:"empty",icon:"happy"},{name:"Informed",emotion:"informed",icon:"nerdy"},{name:"Playful",emotion:"playful",icon:"happy"},{name:"Wise",emotion:"wise",icon:"nerdy"},{name:"Refreshed",emotion:"refreshed",icon:"happy"},{name:"Wanted",emotion:"wanted",icon:"annoyed"},{name:"Thirsty",emotion:"thirsty",icon:"happy"},{name:"Desperate",emotion:"desperate",icon:"happy"}]},e.generateGenres(),e.generateTypes(),e.toastMessage=function(e){var t=r.simple().textContent(e).position("bottom right").parent(jQuery("#alerts"));r.show(t)},e.toastAction=function(e,t,n){var i=r.simple().textContent(e).action(t).hideDelay(0).highlightAction(!1).position("bottom right").parent(jQuery("#alerts"));r.show(i).then(function(e){"ok"==e&&n()})},w.toggleSideNav=m,w.closeSideNav=p,w.toPage=function(e,t){i.go(e,t)},w.notiURL=function(e){e.is_read||w.markAsRead(e),w.toPage(e.main_url.state,e.main_url.args),jQuery("#NotificationsArea").foundation("close")},w.markAllAsSeen=function(){l.where(e.AppData.Notifications.list,{seen:!1});l.each(e.AppData.Notifications.list,function(e){e.seen||(e.seen=!0)}),e.getNewToken("notification",e.AppData.User.id).then(function(t){var n=e.StreamClient.feed("notification",e.AppData.User.id,t);n.get({limit:20,mark_seen:!0},function(t){l.each(e.AppData.Notifications.list,function(e){e.is_seen=!0}),e.AppData.Notifications.unseen=0})})},w.markAllAsRead=function(){e.getNewToken("notification",e.AppData.User.id).then(function(t){var n=e.StreamClient.feed("notification",e.AppData.User.id,t);n.get({limit:20,mark_read:!0},function(t){l.each(e.AppData.Notifications.list,function(e){e.is_read=!0}),e.AppData.Notifications.unread=0;
})})},w.markAsRead=function(t){return t.is_seen||e.getNewToken("notification",e.AppData.User.id).then(function(n){var i=e.StreamClient.feed("notification",e.AppData.User.id,n);i.get({limit:25,mark_read:[t.id],mark_seen:[t.id]}).then(function(e){})["catch"](function(e){}),e.AppData.Notifications.unseen>0&&e.AppData.Notifications.unseen--,t.is_seen=!0}),t},w.doSignOut=function(){o.logout().then(function(e){window.location.reload()})},w.openNotificationsMenu=function(){jQuery("#NotificationsArea").foundation("toggle"),w.markAllAsSeen()},e.toFavorites=w.toFavorites=f,e.toWatchLater=w.toWatchLater=h,e.checkContains=w.checkContains=g,e.isSame=w.isSame=v}function r(e,t,n,i,o,r){var a=this;e.metadata.title="Home",a.refresh=function(){t.collection("projects",{sort:"reactions_count",per_page:8}).then(function(e){a.trending=e.data}),t.collection("projects",{sort:"iwRating",per_page:8}).then(function(e){a.highestRated=e.data}),t.collection("projects",{sort:"wins_count",per_page:8}).then(function(e){a.highestAwarded=e.data}),t.collection("projects",{sort:"created_at",per_page:8}).then(function(e){a.recentFilms=e.data})},a.refresh(),a.refInterval=r(a.refresh,3e5),n.$on("$destroy",function(){r.cancel(a.refInterval)}),i.onfocus=function(){},i.onblur=function(){r.cancel(a.refInterval)}}function a(e,t,n,i,o,r,a,s,c){t.metadata.title="Browse";var l=this;l.isOpen=!1,l.loading=!1,l.selectedGenres=[],l.selectedTypes=[],l.films=[],l.arrs={genres:[],types:[]},l.filters={sort:t.$stateParams.sort||"created_at",genres:t.$stateParams.genres||void 0,type:t.$stateParams.types||void 0,search:t.$stateParams.q||void 0,page:1},t.AppData.searchText=t.$stateParams.q,t.generateTypes().then(function(e){var t=o.defer();return l.arrs.types=angular.isArray(l.selectedTypes)&&l.selectedTypes.length?l.selectedTypes:e,t.promise}),t.generateGenres().then(function(e){var t=o.defer();return l.arrs.genres=angular.isArray(l.selectedGenres)&&l.selectedGenres.length?l.selectedGenres:e,t.promise}),l.refresh=function(){o.all([t.generateTypes(),t.generateGenres()]).then(function(e){l.filters.sort=t.$stateParams.sort||"recent",l.search()})},l.search=function(){l.loading=!0;var n="";switch(l.filters.sort){case"trending":n="reactions_count";break;case"rating":n="iwRating";break;case"awards":n="wins_count";break;case"recent":default:n="created_at"}t.AppData.searchText=t.$stateParams.q=l.filters.search||void 0,i.collection("projects",{sort:n,order:"DESC",types:c.pluck(l.selectedTypes,"id").toString(),genres:c.pluck(l.selectedGenres,"id").toString(),search:l.filters.search||void 0,per_page:50,page:l.filters.page}).then(function(e){return l.pagination=e.data.meta.pagination,l.films=e.data.data}).then(function(){l.loading=!1}),e.$broadcast("scroll.refreshComplete")},l.loadMore=function(){l.loading&&t.toastMessage("Please wait..."),l.loading=!0;var e="";switch(l.filters.sort){case"trending":e="reactions_count";break;case"rating":e="iwRating";break;case"awards":e="wins_count";break;case"recent":default:e="created_at"}i.collection("projects",{sort:e,order:"DESC",types:c.pluck(l.selectedTypes,"id").toString(),genres:c.pluck(l.selectedGenres,"id").toString(),search:l.filters.search||void 0,per_page:50,page:++l.filters.page}).then(function(e){return l.films=c.union(l.films,e.data.data)}).then(function(){l.loading=!1})},l.selectGenres=function(e){var t=c.findWhere(l.selectedGenres,{id:e.id});t?l.selectedGenres=c.reject(l.selectedGenres,e):l.selectedGenres.push(e),l.search()},l.selectTypes=function(e){var t=c.find(l.selectedTypes,{id:e.id});t?l.selectedTypes=c.reject(l.selectedTypes,e):l.selectedTypes.push(e),l.search()},l.filterBy=function(e){l.search()},l.toggleFilterNav=function(){s("filterNav").toggle().then(function(){})},l.refresh()}function s(e,t,n,i,o){e.metadata.title="Latest";var r=this;r.init=function(){n.collection("reactions/latest").then(function(e){r.reactions=e.data}),n.collection("nominations/latest").then(function(e){r.nominations=e.data}),n.collection("critiques/latest").then(function(e){r.critiques=e.data})},r.init(),r.refInterval=o(r.init,1e4),t.$on("$destroy",function(){o.cancel(r.refInterval)}),i(jQuery(document).foundation(),0)}function c(e,t,n,i,o,r,a,s,c,l,u){function d(n){e.currentTitle=n.name,p.loaded=!0,e.metadata={title:n.name,description:angular.isString(n.description)?n.description.substr(0,150):"",image:n.thumbnail_url,url:window.location.href},p.qReactions(),p.qCritiques(),p.qNominations(),p.qWins(),p.checkUserActions(),e.initWatch=function(){s.trackEvent("video","play",p.film.name),o.markAsWatched(p.film)},t.$on("$destroy",function(){e.initWatch=void 0}),p.test=function(){},angular.isString(p.film.tags)&&p.film.tags.length&&p.film.tags.indexOf(",")>-1&&(p.tagsArray=p.film.tags.split(",")),r.collection("projects",{notVideo:p.film.id,notOwner:e.AppData.User?e.AppData.User.id:void 0,per_page:1,random:!0}).then(function(e){e&&(p.relatedvideo=e.data.data[0])})}function m(e){var t=jQuery(".flex-video");e?t.css("z-index",""):t.css("z-index",0)}var p=this;if(p.loaded=!1,p.displayShare=!1,p.toggleReactionsList=!1,p.emotions=e.generateReactions(),p.critiqueAverage=0,p.activeTab="critiques",p.isFaved=!1,p.isSaved=!1,p.playerResponsiveMode=c.localStorage.playerResponsiveMode?JSON.parse(c.localStorage.playerResponsiveMode):u.contains(["small","medium","large"],Foundation.MediaQuery.current),p.tagsArray=[],p.lightsOff=!1,p.film=n,!e.isAuthenticated())var f=e.$watch("AppData.User",function(e,t){e&&angular.isString(e.id)&&(console.log("User Logged In"),p.checkUserActions(),f())});p.checkUserActions=function(){e.isAuthenticated()?(o.canReact(p.film.id).then(function(e){p.canReact=e},function(e){p.canReact=e}),p.film.disableCritique||p.film.owner_id===e.AppData.User.id?(console.log("owner"),p.canCritique=!1):o.canCritique(p.film.id).then(function(e){p.canCritique=e},function(e){p.canCritique=e}),o.canRate(p.film.id).then(function(e){p.canRate=e},function(e){p.canRate=e})):p.canCritique=!0},p.qReactions=function(){r.collection("reactions",{project:p.film.id,sort:"created_at",per_page:300}).then(function(e){p.reactions=e.data,p.chartedReactions=u.countBy(p.reactions.data,function(e){return u.contains(p.reactions.data,e)?e.emotion:void 0}),p.reactionCountMax=u.max(p.chartedReactions,function(e){return e});var t=[];for(var n in p.chartedReactions)t.push([n,p.chartedReactions[n]]);t.sort(function(e,t){return t[1]-e[1]}),p.chartedReactions=u.object(t)})},p.qCritiques=function(){r.collection("critiques",{include:"",project:p.film.id,per_page:100}).then(function(e){p.critiques=e.data.data,p.calcIwAverage(p.critiques)})},p.qNominations=function(){r.collection("nominations",{include:"user,award",project:p.film.id,sort:"created_at",per_page:100}).then(function(e){p.nominations=e.data.data})},p.qWins=function(){r.collection("wins",{project:p.film.id,sort:"created_at"}).then(function(e){p.wins=e.data.data})},p.calcIwAverage=function(e){var t=0;u.each(e,function(e){t+=e.overall}),p.critiqueAverage=t/e.length},p.getEmoticonByEmotion=function(t){var n=e.generateReactions();return u.findWhere(n,{emotion:t})},p.showMessageDialog=function(){o.checkAuth().then(function(e){if(e){var t={templateUrl:"common/contactUserDialog.html",resolve:{recipient:function(){return p.videoOwner.id}},controller:ContactUserDialogController};i.open(t)}},function(e){o.loginModal()})},p.rateThrottled=!1,p.rate=function(t){if(p.rateThrottled)return!1;if(!e.isAuthenticated())return o.loginModal(),!1;if(e.isNotVerified())return e.toastAction("Please verify your account so you can rate videos! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1;p.rateThrottled=!0;var n="like";if(p.canRate===!0)r.save("ratings",{author_id:e.AppData.User.id,project_id:p.film.id,up:"up"===t,down:"down"===t}).then(function(e){switch(t){case"up":p.film.up_ratings_count++;break;case"down":p.film.down_ratings_count++,n="unlike"}p.updateVideoObj(),angular.extend(e.data,{projectOwner:p.film.owner_id}),p.checkUserActions()});else if(angular.isObject(p.canRate))if(p.canRate.up||p.canRate.down){if(p.canRate.up&&"up"===t)angular.extend(p.canRate,{up:!1}),r.update("ratings",p.canRate.id,{up:!1,down:!1}).then(function(e){p.film.up_ratings_count--,angular.extend(e.data,{projectOwner:p.film.owner_id})});else if(p.canRate.down&&"down"===t)angular.extend(p.canRate,{down:!1}),r.update("ratings",p.canRate.id,{up:!1,down:!1}).then(function(e){p.film.down_ratings_count--,angular.extend(e.data,{projectOwner:p.film.owner_id})});else if(p.canRate.down&&"up"===t||p.canRate.up&&"down"===t){var i=!1,a=!1;switch(t){case"up":i=!0,p.film.up_ratings_count++,p.film.down_ratings_count--,angular.extend(p.canRate,{up:i,down:a});break;case"down":a=!0,p.film.up_ratings_count--,p.film.down_ratings_count++,angular.extend(p.canRate,{up:i,down:a}),n="unlike"}r.update("ratings",p.canRate.id,{up:i,down:a}).then(function(e){angular.extend(e.data,{projectOwner:p.film.owner_id})})}}else r.update("ratings",p.canRate.id,{up:"up"===t,down:"down"===t}).then(function(e){switch(t){case"up":p.film.up_ratings_count++;break;case"down":p.film.down_ratings_count++,n="unlike"}angular.extend(p.canRate,{up:"up"===t,down:"down"===t}),angular.extend(e.data,{projectOwner:p.film.owner_id})});l(function(){p.rateThrottled=!1},1e3)},p.react=function(t){if(angular.isDefined(t)){if(!e.isAuthenticated())return o.loginModal(),!1;if(e.isNotVerified())return e.toastAction("Please verify your account and join the conversation! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1;p.canReact===!0?r.save("reactions",{user_id:e.AppData.User.id,project_id:p.film.id,emotion:t.emotion}).then(function(e){p.film.reactions_count++,p.checkUserActions(),p.qReactions()}):angular.isObject(p.canReact)&&p.canReact.emotion!==t.emotion&&r.update("reactions",p.canReact.id,{emotion:t.emotion}).then(function(e){p.canReact=e.data,p.checkUserActions(),p.qReactions()})}},p.canReactIcon=function(){if(angular.isObject(p.canReact)){var e=u.findWhere(p.emotions,{emotion:p.canReact.emotion});return!!angular.isObject(e)&&e.icon}return!1},p.deleteCritique=function(t,n){if(!e.isAuthenticated())return o.loginModal(),!1;if(e.isNotVerified())return e.toastAction("Please verify your account and join the conversation! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1;var a=i.open({templateUrl:"common/confirmDialog.html",controller:["$scope","$modalInstance",function(e,t){e.ok=function(){t.close(!0)},e.cancel=function(){t.dismiss("cancel")}}],size:Foundation.MediaQuery.atLeast("large")?"tiny":"small",keyboard:!0});a.result.then(function(){r.collection("nominations",[],[{critique:t.id}]).then(function(n){var i=n.data.data[0];r["delete"]("Nominations",i.id).then(function(){p.film.nominationCount--}),r["delete"]("Critique",t.id).then(function(){e.toastMessage("Your critique was deleted."),p.film.critiques_count--,p.updateVideoObj(),p.checkUserActions(),p.critiques=u.reject(p.critiques,function(e){return e.id===t.id})})})},function(){})},p.openCritiqueDialog=function(t){function n(t,n,i,o,a,s){m(),t.critique=i,t.film=o,t.ratingMax=10,t.makePrivateHelp=!1,t.processing=!1,t.canNominate=!1,t.errors=[],"39704d3d-2941-11e6-b8db-86ac961c55b2"===t.film.type.id?r.collection("awards",{trailer:!0}).then(function(e){t.awardsList=e.data.Awards}):r.collection("awards").then(function(e){t.awardsList=e.data.Awards}),t.dialogModel={award_id:null},t.nominated={award_id:t.dialogModel.award_id,user_id:e.AppData.User.id,project_id:t.critique.project_id,critique_id:void 0},t.starArray=angular.copy([{num:0},{num:1},{num:2},{num:3},{num:4},{num:5},{num:6},{num:7},{num:8},{num:9},{num:10}].reverse()),t.calcOverall=function(){t.critique.overall=(t.critique.originality+t.critique.direction+t.critique.writing+t.critique.cinematography+t.critique.performances+t.critique.production+t.critique.pacing+t.critique.structure+t.critique.audio+t.critique.music)/10},t.$watchCollection("critique",function(){t.calcOverall()}),t.$watch("critique.overall",function(e){t.canNominate=e>=6}),t.validateCritique=function(){t.errors=[];var e=!0,n=!0;t.critique.body.trim(),e=t.critique.body.length<1,e&&t.errors.push("Tell us why you gave this critique an overall rating of "+t.critique.overall),n=t.critique.originality<1||t.critique.direction<1||t.critique.writing<1||t.critique.cinematography<1||t.critique.performances<1||t.critique.production<1||t.critique.pacing<1||t.critique.structure<1||t.critique.audio<1||t.critique.music<1,n&&t.errors.push("Be sure to put a minimum of 1-star in every category."),e||n||t.postCritique()},t.closeDialog=function(){m(!0),n.close(!0)},t.cancel=function(){m(!0),n.dismiss("cancel")},t.hoveringOver=function(e){t.overStar=e,t.percent=100*(e/t.max)},t.postCritique=function(){return!t.processing&&(t.processing=!0,t.critique.url_id=moment().valueOf(),void r.save("critiques?include=user,award",t.critique).then(function(e){var n=e.data.data;p.critiques.push(n),p.calcIwAverage(p.critiques),p.film.critiques_count++,s.trackEvent("video","critique",p.film.name),t.dialogModel.award_id&&angular.isString(t.dialogModel.award_id)&&(t.nominated.critique_id=n.id,t.nominated.award_id=t.dialogModel.award_id,r.save("nominations",t.nominated).then(function(e){p.film.nominationCount++,p.updateVideoObj(),p.qNominations(),e.critique=n,s.trackEvent("video","nominate",p.film.name)},function(e){alert("Failed to create new nomination, with error code: "+e.message)}))},function(e){alert("Failed to create new critique, with error code: "+e.message),t.processing=!1}).then(function(){p.qCritiques(),p.checkUserActions(),t.closeDialog()}))}}return p.canCritique!==!0&&p.canCritique!==!1?a.go("video_critique",{video_url_id:p.film.url_id,url_id:p.canCritique.url_id}):(n.$inject=["$scope","$modalInstance","critique","film","$q","Analytics"],void o.canCritique(p.film.id).then(function(t){if(t){if(e.isNotVerified())return e.toastAction("Please verify your account and join the conversation! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1;if(p.film.owner_id===e.AppData.User.id)return e.toastMessage("You cannot critique your own content."),!1;i.open({templateUrl:"common/critiqueDialog.html",resolve:{critique:function(){return{originality:0,direction:0,writing:0,cinematography:0,performances:0,production:0,pacing:0,structure:0,audio:0,music:0,overall:0,"private":!1,user_id:e.AppData.User.id,body:"",project_id:p.film.id}},film:function(){return p.film}},controller:n,keyboard:!0})}},function(e){return!angular.isObject(e)&&void o.loginModal()}))},p.openShareDialog=function(){i.open({templateUrl:"common/shareDialog.html",resolve:{Video:function(){return p.film}},size:Foundation.MediaQuery.atLeast("large")?"tiny":"small",controller:["$rootScope","$scope","$modalInstance","Video",function(e,t,n,i){m(),t.video=i,t.shareLink=window.location.origin+"/"+i.url_id,t.cancel=function(){m(!0),n.close()}}]})},p.openReactionDialog=function(){o.checkAuth(p.film.id).then(function(t){if(t){if(e.isNotVerified())return e.toastAction("Please verify your account and join the conversation! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1;var n=i.open({templateUrl:"common/reactionDialog.html",resolve:{Video:function(){return p.film},Reaction:function(){return p.canReact||null},Emotions:function(){return p.emotions}},size:Foundation.MediaQuery.atLeast("medium")?"tiny":"full",controller:["$scope","$modalInstance","Video","Reaction","Emotions",function(e,t,n,i,o){m(),e.video=n,e.emotions=o,e.getEmoticonByEmotion=function(t){return u.findWhere(e.emotions,{emotion:t})},e.selectedEmotion=function(e){m(!0),t.close(e)},e.cancel=function(){m(!0),t.dismiss("cancel")},e.closeDialog=function(){m(!0),t.dismiss("cancel")}}]});n.result.then(function(e){p.react(e)},function(){}).then(function(){l(function(){jQuery("body").removeClass("is-reveal-open")},500)})}},function(e){return!angular.isObject(e)&&void o.loginModal()})},p.openAddToDialog=function(){i.open({templateUrl:"common/shareDialog.html",resolve:{Video:function(){return p.film}},size:Foundation.MediaQuery.atLeast("large")?"tiny":"small",controller:["$scope","$modalInstance","Video",function(e,t,n){m(),e.video=n,e.shareLink=window.location.origin+"/"+n.url_id,e.cancel=function(){m(!0),t.close()}}]})},p.toFavorites=function(){return e.toFavorites(p.film)},p.toWatchLater=function(){return e.toWatchLater(p.film)},p.toggleWidthMode=function(){c.localStorage.playerResponsiveMode=p.playerResponsiveMode=!p.playerResponsiveMode,l(function(){c.videoPlayer.resize(),l(function(){c.videoPlayer.resize()},500)},100)},t.$on("$destroy",function(e){}),p.updateVideoObj=function(){return r.item("projects",p.film.id).then(function(e){console.log("Project Updated: ",e),p.film=e.data.data})},p.toggleLights=function(){p.lightsOff=!p.lightsOff;var e=jQuery("#overlay");e.fadeToggle(1e3),p.lightsOff?e.addClass("highlight"):l(function(){e.removeClass("highlight")},1e3)},p.reportDialog=function(){var t=i.open({templateUrl:"common/reportVideoDialog.html",resolve:{Video:function(){return p.film}},closeOnClick:!1,size:Foundation.MediaQuery.atLeast("medium")?"small":"full",controller:["$scope","$modalInstance","DataService","Video",function(e,t,n,i){m(),e.video=i,e.report={name:"",email:"",body:"",project_id:e.video.id,video:e.video.url_id},e.cancel=function(){m(!0),t.dismiss("cancel")},e.closeDialog=function(){m(!0),t.close(e.report)}}]});t.result.then(function(t){r.mail("report",t).then(function(){e.toastMessage("Your Report has been Sent")})},function(){}).then(function(){l(function(){jQuery("body").removeClass("is-reveal-open")},500)})},d(p.film)}function l(e,t,n,i,o,r){var a=this;a.commentsPage=1;var s=function(e){a.critique=e,t.commentsParent=a.critique,o.collection("comments",{critique:a.critique.id,per_page:10,page:a.commentsPage,replies:!1}).then(function(e){a.comments=e.data})};s(n.data.data)}function u(e,t,n,i,o){t.critique=o.data.data,t.ratingMax=10,t.makePrivateHelp=!1,t.editedCritique=angular.copy(t.critique),n.collection("awards").then(function(e){t.awardsList=e.data.awards}),t.update=function(){t.editedCritique.edited_at=moment().toDate(),n.update("critiques",t.critique.id,t.editedCritique).then(function(n){e.toastMessage("Critique Updated"),i.is("video_critique-edit")&&i.go("video_critique",{video_url_id:e.$stateParams.video_url_id,url_id:t.critique.url_id})},function(t){e.toastMessage("Something went wrong...")})},t.starArray=angular.copy([{num:0},{num:1},{num:2},{num:3},{num:4},{num:5},{num:6},{num:7},{num:8},{num:9},{num:10}].reverse()),t.hoveringOver=function(e){t.overStar=e,t.percent=100*(e/t.max)},t.calcOverall=function(){t.editedCritique.overall=(t.editedCritique.originality+t.editedCritique.direction+t.editedCritique.writing+t.editedCritique.cinematography+t.editedCritique.performances+t.editedCritique.production+t.editedCritique.pacing+t.editedCritique.structure+t.editedCritique.audio+t.editedCritique.music)/10},t.$watchCollection("editedCritique",function(){t.calcOverall()})}function d(e,t,n,i,o,r,a){function s(){t.pick({cropRatio:32/7,mimetype:"image/*",services:["CONVERT","COMPUTER","FACEBOOK","GOOGLE_DRIVE","WEBCAM","INSTAGRAM"],conversions:["crop","rotate","filter"],customSourcePath:e.AppData.user.url_id+"/banners"},function(t){l.user.coverPhoto=t.url+"?cache=true",o.updateUser(l.user).then(function(t){e.toastMessage("Cover Photo Updated!")})})}function c(){t.pick({cropRatio:1,mimetype:"image/*",services:["CONVERT","COMPUTER","FACEBOOK","GOOGLE_DRIVE","WEBCAM","INSTAGRAM"],conversions:["crop","rotate","filter"],customSourcePath:e.AppData.user.url_id+"/avatars"},function(t){l.user.avatar=t.url+"?cache=true",o.updateUser(l.user).then(function(t){e.toastMessage("Avatar Updated!")})})}e.metadata.title="Profile";var l=this;l.user=n,l.userStats=i,l.pickAvatar=c,l.pickBanner=s,l.getEmoticonByEmotion=function(t){var n=e.generateReactions();return a.findWhere(n,{emotion:t})},l.generatePublicId=function(e){return l.user.url_id+"_"+e+"_"+moment().valueOf()}}function m(e,t,n,i,o,r,a,s,c){var l=this;l.user=n.data,l.uploadType=2,l.newVideo={name:"",description:"",director:"",writer:"",producers:"",keyCast:"",language:"00000000-0000-6b6e-4371-305344643451",completionDate:"",filmingCountry:void 0,originCountry:void 0,owner:e.AppData.User.id,genres:[],type:void 0,runTime:0,thumbnail_url:"",hosting_type:void 0,video_url:"",tags:"",unlist:!1,disableComments:!1,disableCritique:!1,nsfw:!1,copyrightOwner:!1},l.genresArr=[],l.runtime={hours:0,mins:0,secs:0},l.maxDate=moment().toDate(),l.selectedGenre=null,e.generateGenres().then(function(t){e.genresList=l.genresList=t}),e.generateTypes().then(function(t){e.typesList=l.typesList=t}),e.generateCountries().then(function(t){e.countryList=l.countryList=t}),e.generateLanguages().then(function(t){e.languageList=l.languageList=t}),l.runtimeToSeconds=function(){l.newVideo.runTime=3600*l.runtime.hours+60*l.runtime.mins+l.runtime.secs},l.isURL=function(e){var t="[-a-zA-Z0-9@:%._+~#=]{2,256}.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)",n=new RegExp(t,"i");return e.length<2083&&n.test(e)},l.getThumbnailUrl=function(e){if(null!=e&&""!=e){if(e.indexOf("youtu")!=-1){var t=e.indexOf("v=")!=-1?e.split("v=")[1].split("&")[0]:e.split("be/")[1];return l.newVideo.hosting_type="youtube",l.newVideo.hosting_id=t,l.newVideo.thumbnail_url="https://img.youtube.com/vi/"+t+"/hqdefault.jpg"}if(e.indexOf("vimeo")!=-1){var t=e.split(".com/")[1];l.newVideo.hosting_type="vimeo",l.newVideo.hosting_id=t,i.jsonp("https://api.vimeo.com/videos/"+t+"/pictures.json?callback=JSON_CALLBACK").then(function(e){return l.newVideo.thumbnail_url=angular.isDefined(e.data[0].sizes[6])?e.data[0].sizes[6]:angular.isDefined(e.data[0].sizes[5])?e.data[0].sizes[5]:angular.isDefined(e.data[0].sizes[4])?e.data[0].sizes[4]:e.data[0].sizes[3]})}else if(e.indexOf("dailymotion")!=-1){var t=e.split("video/")[1].split("_")[0];l.newVideo.hosting_type="dailymotion",l.newVideo.hosting_id=t,i.get("https://api.dailymotion.com/video/"+t+"?fields=thumbnail_large_url").then(function(e){return l.newVideo.thumbnail_url=e.data.thumbnail_large_url})}else e.indexOf("youku")!=-1?(l.newVideo.hosting_type="youku",l.newVideo.hosting_id=void 0):e.indexOf("vine")!=-1&&(l.newVideo.hosting_type="vine",l.newVideo.hosting_id=void 0,i.get("/utils/get-vine-data.php?url="+e).then(function(e){return l.newVideo.thumbnail_url=e.data}))}},l.validateNewVideoForm=function(){var t=!0,n="Your project is missing:";return l.newVideo.name.length||(n+="Project Title, ",e.toastMessage(),t=!1),2!=l.uploadType||l.newVideo.video_url.length||(n+="Video URL, ",t=!1),(angular.isUndefined(l.genresArr)||angular.isArray(l.genresArr)&&!l.genresArr.length)&&(n+="Genres, ",t=!1),angular.isUndefined(l.newVideo.type)&&(n+="Type, ",t=!1),angular.isUndefined(l.newVideo.language)&&(n+="Language, ",t=!1),0==l.newVideo.runTime&&(n+="Duration",t=!1),t||(e.toastMessage(n),alert(n)),t},l.syncGenres=function(e,t){if(e)l.genresArr.push(t);else for(var n=0;n<l.genresArr.length;n++)l.genresArr[n].id==t.id&&l.genresArr.splice(n,1)},l.isCheckedGenre=function(e){for(var t=!1,n=0;n<l.genresArr.length;n++)l.genresArr[n].id==e&&(t=!0);return t},l.submitNewVideo=function(){if(l.validateNewVideoForm()){angular.isArray(l.genresArr)&&l.genresArr.length&&(l.newVideo.genres=c.pluck(l.genresArr,"id"));var n={name:l.newVideo.name,description:l.newVideo.description,director:l.newVideo.director,writer:l.newVideo.writer,producers:l.newVideo.producers,keyCast:l.newVideo.keyCast,completionDate:moment({year:l.newVideo.completionDate}).startOf("year").format("YYYY-MM-DD HH:MM:SS"),owner_id:l.newVideo.owner,runTime:l.newVideo.runTime,video_url:l.newVideo.video_url,thumbnail_url:l.newVideo.thumbnail_url,hosting_type:l.newVideo.hosting_type,hosting_id:l.newVideo.hosting_id,tags:l.newVideo.tags,disableComments:l.newVideo.disableComments||!1,disableCritique:l.newVideo.disableCritique||!1,language_id:l.newVideo.language,filmingCountry_id:l.newVideo.filmingCountry,type_id:l.newVideo.type,unlist:l.newVideo.unlist,nsfw:l.newVideo.nsfw,copyrightOwner:l.newVideo.copyrightOwner,genres:l.newVideo.genres};o.save("projects",n).then(function(n){console.log(n.data.data),e.toastMessage("Video Uploaded Successfully"),t.go("video",{url_id:n.data.data.url_id})},function(e){alert("Failed to create new video, with error: "+e.message)})}else e.toastMessage("Please check the form!")},l.pickArtwork=function(){s.pick({cropRatio:4/3,mimetype:"image/*",services:["CONVERT","COMPUTER","FACEBOOK","GOOGLE_DRIVE","INSTAGRAM","URL"],conversions:["crop","rotate","filter"],customSourcePath:e.AppData.user.url_id+"/films"},function(t){l.newVideo.thumbnail_url=t.url+"?cache=true",e.$digest()})},l.uploadArtwork=function(e){a.upload({url:"https://api.cloudinary.com/v1_1/indiewise/upload",params:{upload_preset:"dzachn6p"},data:{file:e},skipAuthorization:!0}).then(function(e){console.log("Success "+e.config.data.file.name+"uploaded. Response: "+e.data),l.newVideo.thumbnail_url=e.data.secure_url},function(e){console.log("Error status: "+e.status)},function(e){var t=parseInt(100*e.loaded/e.total);console.log("progress: "+t+"% "+e.config.data.file.name)})},l.files=[],l.pickFile=function(){s.pick({mimetype:"video/mp4",customSourcePath:e.AppData.user.url_id+"/films"},l.onSuccess)},l.onSuccess=function(e){l.newVideo.hosting_type="HTML5",l.newVideo.video_url=e.url+"?cache=true"}}function p(e,t,n,i,o,r,a,s,c){var l=this;if(l.project=o.data.data,l.uploadType=2,l.genresArr=l.project.genres,l.saveComplete=!1,l.editedProject=angular.copy(l.project),angular.extend(l.editedProject,{type_id:l.project.type_id,language_id:l.project.language_id,filmingCountry_id:l.project.filmingCountry_id,completionDate:moment(l.project.completionDate).year()}),l.project.runTime){var u=l.project.runTime;l.runtime={},l.runtime.hours=Math.floor(u/3600),u%=3600,l.runtime.mins=Math.floor(u/60),l.runtime.secs=u%60}angular.isString(l.project.video_url)&&(l.uploadType=2),e.generateGenres().then(function(t){e.genresList=l.genresList=t}),e.generateTypes().then(function(t){e.typesList=l.typesList=t}),e.generateCountries().then(function(t){e.countryList=l.countryList=t}),e.generateLanguages().then(function(t){e.languageList=l.languageList=t}),l.syncGenres=function(e,t){if(e)l.genresArr.push(t);else for(var n=0;n<l.genresArr.length;n++)l.genresArr[n].id==t.id&&(r["delete"]("Genres",l.genresArr[n].id),l.genresArr.splice(n,1))},l.isCheckedGenre=function(e){for(var t=!1,n=0;n<l.genresArr.length;n++)l.genresArr[n].id==e&&(t=!0);return t},l.runtimeToSeconds=function(){l.editedProject.runTime=l.project.runTime=3600*l.runtime.hours+60*l.runtime.mins+l.runtime.secs},l.isURL=function(e){var t="[-a-zA-Z0-9@:%._+~#=]{2,256}.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)",n=new RegExp(t,"i");return e.length<2083&&n.test(e)},l.getThumbnailUrl=function(e){if(null!=e&&""!=e){if(e.indexOf("youtu")!=-1){var t=e.split("v=")[1].split("&")[0];return l.editedProject.thumbnail_url=l.project.thumbnail_url="http://img.youtube.com/vi/"+t+"/mqdefault.jpg"}if(e.indexOf("vimeo")!=-1){var t=e.split(".com/")[1];$http.jsonp("http://www.vimeo.com/api/v2/video/"+t+".json?callback=JSON_CALLBACK").then(function(e){return l.editedProject.thumbnail_url=l.project.thumbnail_url=e.data[0].thumbnail_large})}else if(e.indexOf("dailymotion")!=-1){var t=e.split("video/")[1].split("_")[0];$http.get("https://api.dailymotion.com/video/"+t+"?fields=thumbnail_large_url").then(function(e){return l.editedProject.thumbnail_url=l.project.thumbnail_url=e.data.thumbnail_large_url})}else e.indexOf("youku")!=-1||e.indexOf("vine")!=-1&&$http.get("api/utils/get-vine-data?url="+e).then(function(e){return l.editedProject.thumbnail_url=l.project.thumbnail_url=e.data})}},l.uploadArtwork=function(e){s.upload({url:"https://api.cloudinary.com/v1_1/indiewise/upload",params:{upload_preset:"dzachn6p"},data:{file:e},skipAuthorization:!0}).then(function(e){console.log("Success "+e.config.data.file.name+"uploaded. Response: "+e.data),l.editedProject.thumbnail_url=e.data.secure_url,r.update("projects",l.editedProject.id,l.editedProject)},function(e){console.log("Error status: "+e.status)},function(e){var t=parseInt(100*e.loaded/e.total);console.log("progress: "+t+"% "+e.config.data.file.name)})},l.updateProject=function(){l.editedProject.genres=c.pluck(l.genresArr,"id"),l.editedProject.completionDate=moment({year:l.editedProject.completionDate}).startOf("year").format("YYYY-MM-DD HH:mm:ss"),r.update("projects",l.editedProject.id,l.editedProject).then(function(n){l.saveComplete=!0,e.toastMessage("Video Updated"),t.go("profile.videos")})}}function f(e,t,n,i,o,r,a,s){var c=this;c.user=n.data,c.playlists=i.data.playlists,c.playlistItems=[];var l=r.findWhere(c.playlists,{name:"Favorites","private":!0});c.selectedPlaylist=l?l.id:c.playlists.length?c.playlists[0].id:null,c.loadPlaylistItems=function(){t.collection("playlistItems",{playlist:c.selectedPlaylist,include:"project.owner"}).then(function(e){c.playlistItems=e.data.data})},c.removeItem=function(e){o.checkAuth().then(function(n){n&&t["delete"]("PlaylistItem",e).then(function(){return c.playlists=r.reject(c.playlists,function(t){return t.id===e})})})},angular.isString(c.selectedPlaylist)&&c.loadPlaylistItems()}function h(e,t,n,i,o,r,a,s,c,l,u){function d(){c.localStorage.setItem("pwAllowPushNotifications",h.notificationsActive),h.notificationsActive&&(c.pwCanUseServiceWorkers()||angular.isDefined(window.safari))&&(c.chrome&&c.pushwoosh.isBrowserChrome()?c.pushwoosh.subscribeAtStart():(c.pushwooshSubscribe(),c.pushwooshSetTags({id:h.user.id,urlId:h.user.url_id,username:h.user.email,firstName:h.user.firstName,lastName:h.user.lastName})))}function m(){if(h.updating)e.toastMessage("Please wait...");else{var n=h.user;h.updating=!0,n.genres=s.pluck(h.genresArr,"id"),n.types=s.pluck(h.typesArr,"id"),n.settings=JSON.stringify(n.settings),t.updateUser(n).then(function(n){n.data.data.dob=moment(n.data.data.dob).toDate(),n.data.data.settings=JSON.parse(n.data.data.settings),t.currentUser=h.user=n.data.data,n.data.data.name=n.data.data.fullName,l.update(n.data.data),h.saveComplete=!0,h.updating=!1,a.scrollTo("success"),e.toastMessage("Profile Updated")})}}function p(){t.requestVerification().then(function(){h.verificationEmailSentMessage=!0})}function f(e){var n=u.confirm().title("Terminate Account").textContent("Are you sure you want to terminate your account?").ariaLabel("Terminate Account").targetEvent(e).ok("Yes").cancel("No");u.show(n).then(function(){t.deleteUser().then(function(e){})},function(){})}var h=this;h.countries=[],h.genresArr=[],h.typesArr=[],h.saveComplete=!1,h.updating=!1,n.dob=moment(n.dob).startOf("day").toDate(),n.settings=angular.isObject(n.settings)?n.settings:JSON.parse(n.settings||"{}"),h.user=n,h.genresArr=n.genres,h.typesArr=n.types,h.updateUser=s.throttle(m,1e3);var g=c.localStorage.getItem("pwAllowPushNotifications");h.notificationsActive="undefined"!==g&&!!JSON.parse(g),h.toggleNotifications=d,h.requestVerificationEmail=p,h.confirmTerminate=f,h.verificationEmailSentMessage=!1,e.generateCountries().then(function(e){h.countries=e}),e.generateGenres().then(function(e){h.genresList=e}),e.generateTypes().then(function(e){h.typesList=e}),h.syncGenres=function(e,t){if(e)h.genresArr.push(t);else for(var n=0;n<h.genresArr.length;n++)h.genresArr[n].id==t.id&&(r["delete"]("Genres",h.genresArr[n].id),h.genresArr.splice(n,1))},h.isCheckedGenre=function(e){for(var t=!1,n=0;n<h.genresArr.length;n++)h.genresArr[n].id==e&&(t=!0);return t},h.syncTypes=function(e,t){if(e)h.typesArr.push(t);else for(var n=0;n<h.typesArr.length;n++)h.typesArr[n].id==t.id&&(r["delete"]("UserTypes",h.typesArr[n].id),h.typesArr.splice(n,1))},h.isCheckedType=function(e){for(var t=!1,n=0;n<h.typesArr.length;n++)h.typesArr[n].id==e&&(t=!0);return t}}function g(e,t,n,i,o,r,a,s){var c=this;c.user=n,c.userStats=i,e.metadata.title="Profile: "+c.user.firstName+" "+c.user.lastName,c.showMessageDialog=function(){function e(e,t,n,i,o,r,a){t.recipient=r,t.model={mySubject:e.AppData.User.fullName+", "+t.recipient.fullName,
myMessage:null},t.postMessage=function(){i.checkAuth().then(function(n){n&&o.save("messages",{subject:t.model.mySubject,message:t.model.myMessage,recipients:new Array(t.recipient.id)}).then(function(n){t.model.myMessage=null,e.toastMessage("Message sent!"),t.closeDialog()})},function(t){e.toastMessage("Message failed. Please log in!")})},t.closeDialog=function(){n.close(!0)},t.cancel=function(){n.dismiss("cancel")}}e.$inject=["$rootScope","$scope","$modalInstance","UserActions","DataService","recipient","$timeout"],r.checkAuth().then(function(t){t&&a.open({templateUrl:"common/contactUserDialog.html",resolve:{recipient:function(){return c.user}},controller:e})},function(e){r.loginModal()})}}function v(e,t,n,i,o){var r=this;r.user=n}function y(e,t,n,i,o,r,a){var s=this;s.user=n,s.projects=i.data,s.deleteProject=function(e){r.checkAuth().then(function(n){if(n){var i=o.open({templateUrl:"common/confirmDialog.html",controller:["$scope","$modalInstance",function(e,t){e.ok=function(){t.close(!0)},e.cancel=function(){t.dismiss("cancel")}}],size:Foundation.MediaQuery.atLeast("large")?"tiny":"small",keyboard:!0});i.result.then(function(){t["delete"]("projects",e).then(function(){s.projects.data=a.reject(s.projects.data,function(t){return t.id===e})})},function(){})}})}}function w(e,t,n,i){var o=this;o.user=t,o.critiques=n.data.data,o.critiqued=i.data.data}function A(e,t,n,i,o){var r=this;r.user=t,r.reactions=n.data.data,r.reacted=i.data.data,r.getEmoticonByEmotion=function(t){var n=e.generateReactions();return o.findWhere(n,{emotion:t})}}function C(e,t,n,i,o,r){var a=this;a.user=n,a.awards=i.data.data,a.nominations=o.data.data,a.nominated=r.data.data}function S(e,t,n,i,o,r,a,s,c,l){function u(e){y.newMode=!1,y.selectedConvoLoaded=!1,y.selectedConvo=e,y.currentParticipants=e.participants,i.item("messages",e.id).then(function(e){y.messages=e.data.conversation.messages,y.convoMessages={first:1,data:[],meta:{pagination:{current_page:1}},get:function(e,t,n){console.log("index = "+e+"; count = "+t);var o=e,r=Math.min(e+t-1,this.first);this.meta.pagination.total_pages>=this.meta.pagination.current_page&&this.meta.pagination.current_page++,i.collection("messages/"+y.selectedConvo.id+"/messages",{per_page:t,page:this.meta.pagination.current_page}).then(function(e){y.convoMessages.data=l.union(y.convoMessages.data,e.data.data),angular.extend(y.convoMessages.meta,e.data.meta)}).then(function(){console.log(y.convoMessages);var e=[];if(o<=r)for(var t=o;t<=r;t++){var i=-1*t+y.convoMessages.first,a=y.convoMessages.data[i];a&&e.push(a)}n(e)})}},y.selectedConvoLoaded=!0})}function d(){y.sendOnEnter&&y.myReply&&(y.newMode?y.postNewMsg():y.postReply())}function m(){if(y.myReply){if(y.newMode)return y.postNewMsg();a.checkAuth().then(function(e){if(e){var n=y.myReply;y.myReply=null,i.update("messages",y.selectedConvo.id,{message:n}).then(function(e){y.convoMessages.data.push(e.data.message),t.adapter.append([e.data.message]),y.messages.push(e.data.message),y.fetchConvos()},function(e){y.reply=n}).then(function(){var e=angular.element(".viewport.main-comment");e.scrollTop(e.prop("scrollHeight"))})}},function(e){a.loginModal()})}}function p(){function t(){i.save("messages",{subject:l.pluck(y.selectedConvo.participants,"fullName").toString()+", "+e.AppData.User.fullName,message:y.myReply,recipients:l.pluck(y.selectedConvo.participants,"id")}).then(function(t){y.myReply=null,e.toastMessage("Message sent!"),h().then(function(e){u(l.findWhere(e,{id:t.data.id}))})})}y.newMode=!0,y.selectedConvo={participants:[],body:""},y.postNewMsg=t}function f(t){return i.collection("users",{search:t,notUsers:e.AppData.User.id}).then(function(e){return e.data.data})}function h(){return i.collection("messages").then(function(e){return y.conversations=e.data.conversations})}function g(){var t=r.confirm().title("Leave Conversation?").ok("Yes").cancel("No");r.show(t).then(function(){var t=e.AppData.User.id,n=new Parse.Object("Message");n.set("body",t.first_name+" "+t.last_name+" left the conversation..."),n.set("parent",{__type:"Pointer",className:"Conversation",objectId:y.selectedConvo.id}),n.set("from",e.AppData.User.id),n.save().then(function(e){var n=y.selectedConvo.relation("participants");n.remove(t),y.selectedConvo.set("updatedAt",moment().toDate()),y.selectedConvo.save().then(function(){y.myReply=null,y.messages=[],y.newMode=!1,y.selectedConvo=null,y.currentParticipants=null,h()})})},function(){})}function v(e,t){return l.findWhere(e.participants,{user_id:t})}e.metadata.title="Messages";var y=this;y.selectedConvo=null,y.newConvo=null,y.conversations=n.data.conversations,y.newMode=!1,y.newConversation=p,y.fetchConvos=h,y.querySearch=f,y.leaveConvo=g,y.doSendOnEnter=d,y.postReply=m,y.selectConvo=u,y.getParticipantById=v,y.myReply=null,y.sendOnEnter=!o.localStorage.sendOnEnter||JSON.parse(o.localStorage.sendOnEnter),y.inboxConvos={},y.convoMessages={},y.selectedConvoLoaded=!1,y.viewportHeight={height:"500px"}}function _(e,t,n){var i=this;i.refresh=function(){},i.markAllAsRead=function(){},i.markAsRead=function(e){},i.refresh()}function b(e,t,n,i){var o=this;o.emails=[{title:"Technical Support",address:"support@getindiewise.com",description:"For all your Tech Support Needs and Issues."},{title:"SafeGuard",address:"safeguard@getindiewise.com",description:"IndieWise cares about the safety and well-being of its users. Contact us immediately, if you come across any inappropriate content on the site. This includes, but is not limited to: content that is Excessively Violent, Pornographic, Racially Offensive, Unlawful, of a Bullying Nature, Directly Harmful to any Individual, Copyright Infringement, Spam, etc."},{title:"Marketing",address:"marketing@getindiewise.com",description:"Would you like to advertise your company to our vast and diverse audience? Would you like a featured listing of your film at the top of our Homepage for all to see? Reach out today!"},{title:"Awards",address:"awards@getindiewise.com",description:"So you have such an amazing project, that 5 or more Users felt like you deserve an Award for it! Congrats! We can help!"},{title:"Public Relations",address:"pr@getindiewise.com",description:"Reach out for any press and/or media inquiries. Also let us know if youd like to be featured in our bi-weekly newsletter. Also stay tuned for important announcements and updates!"},{title:"Career Center",address:"careers@getindiewise.com",description:"Interested in joining Team IndieWise? Let us know! There are several internship opportunities available."},{title:"Become a Sponsor",address:"sponsor@getindiewise.com",description:"Weve reserved a unique spot on our homepage to showcase our amazing sponsors. If youre interested in becoming a sponsor of IndieWise, let us know!"},{title:"Invest in IndieWise",address:"investors@getindiewise.com",description:"So youd like to take the bold step of investing in IndieWise! Great choice. Lets talk!"},{title:"Register for IndieWise Convention (JULY 28-30, 2017)",address:"convention@getindiewise.com",description:"Register for our Annual Convention, in Miami, FL! Registration opens on JAN 2, 2017. Over 10,000 Filmmakers from 140+ Countries will be in attendance, as we provide you with 3 days of interactive workshops, educational seminars, film screenings, VIP Receptions, a Yacht Party, and a Closing Gala.<br>Regular 3- Day Package: $150  |  VIP 3-Day Package (Including Yacht Party): $250 (450 Tickets max. To Be Sold)"},{title:"Feedback Center",address:"feedback@getindiewise.com",description:"We welcome any feedback you have, to help us to provide you with the very best experience! Tell us!"}],o.selectedEmail=i.contains(i.pluck(o.emails,"address"),e.$stateParams.email)?i.findWhere(o.emails,{address:e.$stateParams.email}):null,o.description="",o.getDescription=function(){o.description=angular.isObject(o.selectedEmail)?n.trustAsHtml(o.selectedEmail.description):n.trustAsHtml("")},o.getDescription(),o.form={to:"",name:"",email:"",subject:"",message:""},o.submitForm=function(){o.form.to=o.selectedEmail.address,t.mail("contact",o.form).then(function(t){e.toastMessage("Message Sent, Thank you!"),o.form={to:"",name:"",email:"",subject:"",message:""}})}}angular.module("IndieWise.controllers",[]).controller("SignInCtrl",n).controller("ForgotPasswordCtrl",i).controller("RegisterCtrl",t).controller("ProfileCtrl",d).controller("ProfileAboutController",v).controller("ProfilePlaylistsController",f).controller("ProfileVideosController",y).controller("ProfileVideoEditCtrl",p).controller("ProfileCritiquesController",w).controller("ProfileReactionsController",A).controller("ProfileAwardsController",C).controller("ProfileSettingsController",h).controller("ProfileUploadController",m).controller("UserCtrl",g).controller("UserAboutController",v).controller("UserVideosController",y).controller("UserCritiquesController",w).controller("UserReactionsController",A).controller("UserAwardsController",C).controller("MessagesCtrl",S).controller("NotificationsCtrl",_).controller("BodyCtrl",o).controller("HomeCtrl",r).controller("BrowseCtrl",a).controller("LatestCtrl",s).controller("VideoCtrl",c).controller("VideoCritiqueCtrl",l).controller("VideoCritiqueEditCtrl",u).controller("ContactPageCtrl",b),t.$inject=["$rootScope","$timeout","$q","$state","AuthService","DataService","anchorSmoothScroll","_"],n.$inject=["$rootScope","$timeout","$q","$state","AuthService","$modal","cfpLoadingBar"],i.$inject=["$rootScope","$state","AuthService"],o.$inject=["$rootScope","$localForage","$q","$state","AuthService","$mdToast","UserActions","$sce","DataService","_","$interval","$mdSidenav"],r.$inject=["$rootScope","DataService","$scope","$window","$modal","$interval"],a.$inject=["$scope","$rootScope","$state","DataService","$q","$timeout","$modal","$mdSidenav","_"],s.$inject=["$rootScope","$scope","DataService","$timeout","$interval"],c.$inject=["$rootScope","$scope","Project","$modal","UserActions","DataService","$state","Analytics","$window","$timeout","_"],l.$inject=["$rootScope","$scope","Critique","UserActions","DataService","_"],u.$inject=["$rootScope","$scope","DataService","$state","Critique"],d.$inject=["$rootScope","filepickerService","User","UserStats","AuthService","Upload","_"],m.$inject=["$rootScope","$state","User","$http","DataService","$window","Upload","filepickerService","_"],p.$inject=["$rootScope","$state","$modal","UserActions","Project","DataService","anchorSmoothScroll","Upload","_"],f.$inject=["$rootScope","DataService","User","Playlists","UserActions","_","$interval","$http"],h.$inject=["$rootScope","AuthService","User","Genres","UserTypes","DataService","anchorSmoothScroll","_","$window","$intercom","$mdDialog"],g.$inject=["$rootScope","DataService","User","UserStats","$state","UserActions","$modal","_"],v.$inject=["$rootScope","DataService","User","$state","UserActions"],y.$inject=["$rootScope","DataService","User","Videos","$modal","UserActions","_"],w.$inject=["$rootScope","User","Critiques","Critiqued"],A.$inject=["$rootScope","User","Reactions","Reacted","_"],C.$inject=["$rootScope","DataService","User","Awards","Nominations","Nominated"],S.$inject=["$rootScope","$scope","Conversations","DataService","$window","$modal","UserActions","$timeout","$q","_"],_.$inject=["$rootScope","UserActions","_"],b.$inject=["$rootScope","DataService","$sce","_"]}(),function(){"use strict";function e(){}angular.module("IndieWise.winners",[]).controller("WinnersCtrl",e),e.$inject=[]}(),function(){"use strict";angular.module("IndieWise.directives",[]).directive("layerSlider",["$rootScope","$timeout","DataService","$q",function(e,t,n,i){return{restrict:"E",transclude:!0,templateUrl:"directives/layerSlider.html",scope:{},link:function(e,o,r){e.BASE=BASE||"/";var a=n.collection("users/count").then(function(t){e.users=t.data}),s=n.collection("projects/count").then(function(t){e.projects=t.data});i.all([a,s]).then(function(){t(function(){jQuery("#layerslider").layerSlider({responsive:!1,responsiveUnder:1280,layersContainer:1280,skin:"noskin",hoverPrevNext:!1,skinsPath:BASE+"assets/layerslider/skins/"})},0)})}}}]).directive("premiumCarousel",["$rootScope","$state","$timeout","DataService",function(e,t,n,i){return{restrict:"E",replace:!0,templateUrl:"directives/featured-area.html",scope:{},link:function(t,o,r){i.collection("projects",{random:!0}).then(function(e){t.featuredFilms=e.data}).then(function(){n(function(){var e=jQuery("#owl-featured");e.each(function(){var t=jQuery(this);jQuery(".prev").on("click",function(){e.trigger("prev.owl.carousel")}),jQuery(".next").on("click",function(){e.trigger("next.owl.carousel")});var n=t.data("car-length"),i=jQuery(this).find("div.item").length;i>n?t.owlCarousel({dots:t.data("dots"),items:t.data("items"),slideBy:t.data("slideby"),center:t.data("center"),loop:t.data("loop"),margin:t.data("margin"),nav:t.data("nav"),autoplay:t.data("autoplay"),autoplayTimeout:t.data("autoplay-timeout"),autoWidth:t.data("auto-width"),autoHeight:t.data("auto-Height"),merge:t.data("merge"),responsive:{0:{items:t.data("responsive-small"),nav:!1},600:{items:t.data("responsive-medium"),nav:!1},1e3:{items:t.data("responsive-large"),nav:!1},1900:{items:t.data("responsive-xlarge"),nav:!1}}}):t.owlCarousel({dots:!1,items:t.data("items"),loop:!1,margin:t.data("margin"),autoplay:!1,autoplayHoverPause:!0,responsiveClass:!0,autoWidth:t.data("auto-width"),autoHeight:t.data("auto-Height")})})},300)}),t.isMobile=e.isMobile}}}]).directive("watchingCarousel",["$rootScope","$timeout","$interval","DataService",function(e,t,n,i){return{restrict:"E",replace:!0,templateUrl:"directives/people-watching.html",scope:{},link:function(e,n,o){e.getWatchedList=function(){i.collection("projects/watched").then(function(n){e.watched=n.data,t(function(){jQuery(".owl-carousel").each(function(){var e=jQuery(this);jQuery(".prev").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("prev.owl.carousel")}),jQuery(".next").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("next.owl.carousel")});var t=e.data("car-length"),n=jQuery(this).find("div.item").length;n>t?e.owlCarousel({dots:e.data("dots"),items:e.data("items"),slideBy:e.data("slideby"),center:e.data("center"),loop:e.data("loop"),margin:e.data("margin"),nav:e.data("nav"),autoplay:e.data("autoplay"),autoplayTimeout:e.data("autoplay-timeout"),autoWidth:e.data("auto-width"),autoHeight:e.data("auto-Height"),merge:e.data("merge"),responsive:{0:{items:e.data("responsive-small"),nav:!1},600:{items:e.data("responsive-medium"),nav:!1},1e3:{items:e.data("responsive-large"),nav:!1},1900:{items:e.data("responsive-xlarge"),nav:!1}}}):e.owlCarousel({dots:!1,items:e.data("items"),loop:!1,margin:e.data("margin"),autoplay:!1,autoplayHoverPause:!0,responsiveClass:!0,autoWidth:e.data("auto-width"),autoHeight:e.data("auto-Height")})})},0)})},e.getWatchedList()}}}]).directive("owlCarousel",["$rootScope","$timeout","$interval","DataService",function(e,t,n,i){return{restrict:"A",link:function(e,n,i){e.getWatchedList=function(){t(function(){n.each(function(){var e=jQuery(this);jQuery(".prev").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("prev.owl.carousel")}),jQuery(".next").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("next.owl.carousel")});var t=e.data("car-length"),n=jQuery(this).find("div.item").length;n>t?e.owlCarousel({dots:e.data("dots"),items:e.data("items"),slideBy:e.data("slideby"),center:e.data("center"),loop:e.data("loop"),margin:e.data("margin"),nav:e.data("nav"),autoplay:e.data("autoplay"),autoplayTimeout:e.data("autoplay-timeout"),autoWidth:e.data("auto-width"),autoHeight:e.data("auto-Height"),merge:e.data("merge"),responsive:{0:{items:e.data("responsive-small"),nav:!1},600:{items:e.data("responsive-medium"),nav:!1},1e3:{items:e.data("responsive-large"),nav:!1},1900:{items:e.data("responsive-xlarge"),nav:!1}}}):e.owlCarousel({dots:!1,items:e.data("items"),loop:!1,margin:e.data("margin"),autoplay:!1,autoplayHoverPause:!0,responsiveClass:!0,autoWidth:e.data("auto-width"),autoHeight:e.data("auto-Height")})})},0)},e.getWatchedList()}}}]).directive("playlists",["$rootScope","DataService","UserActions","_",function(e,t,n,i){return{restrict:"E",templateUrl:"directives/playlists.html",replace:!1,scope:{project:"="},link:function(o,r,a){o.model={newName:null,playlistArr:[]},o.playlists=[],o.newPlInput=!1,e.AppData.User&&t.collection("playlists").then(function(e){t.collection("playlistItems",{project:o.project.id,playlists:i.pluck(e.data.playlists,"id").toString()}).then(function(t){o.model.playlistArr=t.data.data,o.playlists=e.data.playlists})}),o.toggleNewPlInput=function(e){o.newPlInput=!o.newPlInput,e&&(o.model.newName=null)},o.newPlaylist=function(){n.checkAuth().then(function(n){t.save("playlists",{name:o.model.newName,user_id:e.AppData.User.id},!1,!0).then(function(e){o.toggleNewPlInput(!1),o.model.newName=null,o.playlists.push(e.data.data)})},function(e){n.loginModal().then(function(e){})})},o.syncPlaylists=function(n,r){if(n)o.model.playlistArr.push(r),t.save("playlistItems",{playlist:r.id,project:o.project.id}),e.toastMessage("Added to playlist");else for(var a=0;a<o.model.playlistArr.length;a++)if(o.model.playlistArr[a].id==r.id){var s=i.findWhere(o.model.playlistArr,{project:o.project.id,playlist_id:r.id});s&&t["delete"]("PlaylistItem",s.id),o.model.playlistArr.splice(a,1),e.toastMessage("Removed from playlist")}},o.isCheckedPlaylist=function(e){for(var t=!1,n=0;n<o.model.playlistArr.length;n++)o.model.playlistArr[n].playlist_id==e&&(t=!0);return t}}}}]).directive("toggleShowMore",["$rootScope","$timeout",function(e,t){return{restrict:"A",scope:{showMoreHeight:"=showMoreHeight"},link:function(e,n,i){t(function(){n.showMore({speedDown:300,speedUp:300,height:e.showMoreHeight?e.showMoreHeight+"px":"165px",showText:"Show more",hideText:"Show less"})},500)}}}]).directive("elitePlayer",["$rootScope","DataService","UserActions","$timeout","$interval","$state","anchorSmoothScroll","_",function(e,t,n,i,o,r,a,s){return{restrict:"E",templateUrl:"directives/videoPlayer.html",scope:{film:"=film",type:"=type",lightsOff:"=lightsOff"},link:function(n,a,c){function l(t){if(!/^https?:\/\/player.vimeo.com/.test(t.origin))return!1;var i=JSON.parse(t.data);"playProgress"===i.event&&(m||(n.lightsOff&&u(),e.initWatch(),m=!0,o.cancel(n.startedPlaying)),window.addEventListener?window.removeEventListener("message",l,!1):window.detachEvent("onmessage",l))}function u(){n.lightsOff=!n.lightsOff;var e=jQuery("#overlay");e.fadeToggle(1e3),n.lightsOff?e.addClass("highlight"):i(function(){e.removeClass("highlight")},1e3)}var d=!1,m=!1,p=[],f=n.film;p.push({videoType:n.type,title:f.name,youtubeID:"youtube"===n.type?f.hosting_id:"",vimeoID:"vimeo"===n.type?f.hosting_id:"",mp4:"HTML5"===n.type?f.video_url:"",imageUrl:f.thumbnail_url,imageTimer:4,prerollAD:"no",prerollGotoLink:"http://getindiewise.com/",prerollSkipTimer:5,midrollAD:"no",midrollAD_displayTime:"00:10",midrollGotoLink:"http://getindiewise.com/",midrollSkipTimer:5,postrollAD:"no",postrollGotoLink:"http://getindiewise.com/",postrollSkipTimer:5,popupAdShow:"no",popupAdStartTime:"00:03",popupAdEndTime:"00:07",popupAdGoToLink:"http://getindiewise.com/",description:f.description,thumbImg:f.thumbnail_url||"/assets/img/default_avatar.jpg",info:""}),t.collection("projects",{owner:f.owner.id,notVideo:f.id,per_page:20}).then(function(e){return n.playlistFilms=e.data.data,n.playlistFilms}).then(function(e){s.each(e,function(e){var t="";t=e.video_url.indexOf("youtu")!=-1?"youtube":e.video_url.indexOf("vimeo")!=-1?"vimeo":"other",p.push({videoType:t,title:e.name,youtubeID:"youtube"===t?e.hosting_id:"",vimeoID:"vimeo"===t?e.hosting_id:"",mp4:"hosted"===t?e.video_url:"",prerollAD:"no",prerollGotoLink:"http://getindiewise.com/",preroll_mp4:"http://creativeinteractivemedia.com/player/videos/Short_Elegant_Logo_Reveal.mp4",prerollSkipTimer:5,midrollAD:"no",midrollAD_displayTime:"00:10",midrollGotoLink:"http://getindiewise.com/",midroll_mp4:"http://creativeinteractivemedia.com/player/videos/Logo_Explode.mp4",midrollSkipTimer:5,postrollAD:"no",postrollGotoLink:"http://getindiewise.com/",postroll_mp4:"http://creativeinteractivemedia.com/player/videos/Logo_Light.mp4",postrollSkipTimer:5,popupImg:"images/preview_images/popup.jpg",popupAdShow:"no",popupAdStartTime:"00:03",popupAdEndTime:"00:07",popupAdGoToLink:"http://getindiewise.com/",description:e.url_id,thumbImg:e.thumbnail_url||"/assets/img/default_avatar.jpg",info:""})})})["finally"](function(){window.videoPlayer=n.videoPlayer=a.Video({instanceName:"player1",instanceTheme:"dark",autohideControls:2,hideControlsOnMouseOut:"No",playerLayout:"fitToContainer",responsive:!0,playlist:"Right playlist",playlistScrollType:"light",playlistBehaviourOnPageload:"closed",autoplay:!1,colorAccent:"#3F51B5",vimeoColor:"00adef",youtubeControls:"custom controls",youtubeSkin:"dark",youtubeColor:"red",youtubeQuality:"default",youtubeShowRelatedVideos:"No",videoPlayerShadow:"effect2",loadRandomVideoOnStart:"No",shuffle:"No",posterImg:"",onFinish:"Stop video",nowPlayingText:"Yes",fullscreen:"Fullscreen native",rightClickMenu:!1,hideVideoSource:!0,showAllControls:!0,allowSkipAd:!0,infoShow:"No",shareShow:"No",facebookShow:"No",twitterShow:"No",mailShow:"No",facebookShareName:f.name,facebookShareLink:window.location.href,facebookShareDescription:f.description,facebookSharePicture:f.thumbnail_url,twitterText:f.name,twitterLink:window.location.href,twitterHashtags:"indiewise",twitterVia:"IndieWise",googlePlus:window.location.href,logoShow:"Yes",logoClickable:"No",logoPath:"/assets/img/Logo_alt2_web_87x45.png",logoGoToLink:"http://getindiewise.com",logoPosition:"bottom-left",embedShow:"No",embedCodeSrc:"www.yourwebsite.com/videoplayer/index.html",embedCodeW:"746",embedCodeH:"420",embedShareLink:window.location.href,youtubePlaylistID:"",youtubeChannelID:"",videos:p}),a.find(".elite_vp_item:not(:first) *").bind("click",function(e){e.preventDefault();var t=jQuery(this).hasClass("elite_vp_item")?jQuery(this):jQuery(this).parents(".elite_vp_item"),n=t.find(".elite_vp_description"),i=n.html().trim();r.go("video",{url_id:i})}),a.find(".fa-elite-backward").bind("click",function(e){e.preventDefault();var t=jQuery(".elite_vp_itemSelected").prev();t.length||(t=jQuery(".elite_vp_item").last());var n=t.find(".elite_vp_description"),i=n.html().trim();r.go("video",{url_id:i})}),a.find(".fa-elite-forward").bind("click",function(e){e.preventDefault();var t=jQuery(".elite_vp_itemSelected").next(),n=t.find(".elite_vp_description"),i=n.html().trim();r.go("video",{url_id:i})}),n.startedPlaying=o(function(){if("loading"===n.videoPlayer.state&&angular.element("#elite_vp_vimeoWrapper iframe")&&(d||(window.addEventListener?window.addEventListener("message",l,!1):window.attachEvent("onmessage",l),d=!0)),"elite_vp_playing"===n.videoPlayer.state){switch(u(),e.initWatch(),n.type){case"youtube":n.videoPlayer.youtubePlayer.addEventListener("onStateChange",function(e){0==e.target.getPlayerState()&&n.lightsOff&&u()})}o.cancel(n.startedPlaying)}},1e3)}),jQuery("#overlay").on("click",function(){u()})}}}]).directive("elitePlayerEmbed",["$rootScope","_",function(e,t){return{restrict:"E",templateUrl:"directives/videoPlayer.html",scope:{name:"=",hosting_id:"=",url:"=",type:"=",thumbnail:"=",description:"="},link:function(e,t,n){var i=[];i.push({videoType:e.type,title:e.name,youtubeID:"youtube"===e.type?e.hosting_id:"",vimeoID:"vimeo"===e.type?e.hosting_id:"",mp4:"HTML5"===e.type?e.url:"",imageUrl:e.thumbnail,imageTimer:4,prerollAD:"no",prerollGotoLink:"http://getindiewise.com/",prerollSkipTimer:5,midrollAD:"no",midrollAD_displayTime:"00:10",midrollGotoLink:"http://getindiewise.com/",midrollSkipTimer:5,postrollAD:"no",postrollGotoLink:"http://getindiewise.com/",postrollSkipTimer:5,popupAdShow:"no",popupAdStartTime:"00:03",popupAdEndTime:"00:07",popupAdGoToLink:"http://getindiewise.com/",description:"",thumbImg:e.thumbnail,info:""}),e.videoPlayer=t.Video({instanceName:"player_"+(new Date).valueOf().toString(),instanceTheme:"dark",autohideControls:2,hideControlsOnMouseOut:"No",playerLayout:"fixedSize",videoPlayerWidth:"100%",videoPlayerHeight:Foundation.MediaQuery.atLeast("large")?470:420,playlist:"Off",playlistScrollType:"light",playlistBehaviourOnPageload:"closed",autoplay:!1,colorAccent:"#3F51B5",vimeoColor:"00adef",youtubeControls:"custom controls",youtubeSkin:"dark",youtubeColor:"red",youtubeQuality:"default",youtubeShowRelatedVideos:"No",videoPlayerShadow:"effect2",loadRandomVideoOnStart:"No",shuffle:"No",posterImg:"",onFinish:"Stop video",nowPlayingText:"Yes",fullscreen:"Fullscreen native",rightClickMenu:!1,hideVideoSource:!0,showAllControls:!0,allowSkipAd:!0,infoShow:"No",shareShow:"No",facebookShow:"No",twitterShow:"No",mailShow:"No",facebookShareName:e.name,facebookShareLink:window.location.href,facebookShareDescription:e.description,facebookSharePicture:e.thumbnail,twitterText:e.name,twitterLink:window.location.href,twitterHashtags:"indiewise",twitterVia:"IndieWise",googlePlus:window.location.href,logoShow:"Yes",logoClickable:"No",logoPath:"/assets/img/Logo_alt2_web_87x45.png",logoGoToLink:"http://getindiewise.com",logoPosition:"bottom-left",embedShow:"No",embedCodeSrc:"www.yourwebsite.com/videoplayer/index.html",embedCodeW:"746",embedCodeH:"420",embedShareLink:window.location.href,youtubePlaylistID:"",youtubeChannelID:"",videos:i})}}}]).directive("offCanvasNav",["$rootScope",function(e){return{restrict:"A",link:function(e,t,n){t.find("a").on("click",function(){angular.element("#offCanvas-responsive").foundation("close")})}}}]).directive("messagesHeight",["$window",function(e){return{restrict:"A",link:function(t,n,i){function o(){var i=n.parent(),o=n.prev().height(),r=n.next().height(),a=e.innerHeight-(i.offset().top+o+r);t.Msgs.viewportHeight={height:a+"px"}}o(),angular.element(e).bind("resize",function(){o(),t.$digest()})}}}]).directive("sideNavNotif",["$mdSidenav",function(e){return{restrict:"A",link:function(t,n,i){n.find("a").bind("click",function(){e("right").close()})}}}]).directive("helpInfo",[function(){return{restrict:"E",transclude:!0,templateUrl:"directives/help-info.html",scope:{text:"=text",direction:"=direction"}}}]).directive("projectCard",["$rootScope","$state","$modal","$mdMedia","UserActions",function(e,t,n,i,o){return{restrict:"E",transclude:!0,replace:!1,templateUrl:"directives/project-card.html",scope:{video:"=video",type:"=type",related:"=related",queried:"=queried"},link:function(t,i,o){function r(e){n.open({templateUrl:"common/shareDialog.html",resolve:{Video:function(){return e}},controller:["$scope","$modalInstance","Video",function(e,t,n){e.video=n,e.shareLink=window.location.origin+"/"+n.url_id,e.cancel=function(){t.close()}}]})}t.isQueried="true"===t.queried,t.isLoggedIn=e.AppData.User,t.openShareDialog=r}}}]).directive("commentsBlock",["$rootScope","DataService","UserActions","$modal","_",function(e,t,n,i,o){return{restrict:"E",templateUrl:"directives/comments.html",scope:{comments:"=comments",disable:"=disable",parent:"=parent"},link:function(r,a,s){function c(){return e.isAuthenticated()?e.isNotVerified()?(e.toastAction("Please verify your account so you can rate videos! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1):void t.save("comments",{body:r.model.myComment,critique_id:r.parent.hasOwnProperty("unlist")?void 0:r.parent.id,user_id:r.model.isLoggedIn.id}).then(function(t){r.comments.data.push(t.data.data),e.toastMessage("Comment posted!"),r.model.myComment=null,m(),r.parent.comments_count++},function(e){console.log("Failed to create new comment, with error code: "+e.message)}):(n.loginModal(),!1)}function l(a,s){n.checkAuth().then(function(n){if(n){var c=i.confirm().title("Would you like to delete your comment?").targetEvent(s).ok("Delete").cancel("Cancel");i.show(c).then(function(){var n=a.parentComment||void 0;t["delete"]("comments",a.id).then(function(t){if(r.parent.commentCount--,!angular.isUndefined(n)){var i=o.find(r.comments,function(e){return e.id===n.id});i.replies=o.reject(i.replies,function(e){return e.id===a.id});var s=new Parse.Query("Comment");return s.get(n.id).then(function(e){e.increment("replyCount",-1),e.save()}),a=void 0}r.comments=o.reject(r.comments,function(e){return e.id===a.id}),e.toastMessage("Your comment was deleted.")})},function(){})}})}function u(e){return e.repliesLoaded?(e.showReplies=!e.showReplies,e):void t.collection("comments",{comment:e.id}).then(function(t){return e.replies=t.data.data,e.repliesLoaded=!0,e.showReplies=!e.showReplies,e})}function d(){r.showCommentInput=!r.showCommentInput}function m(){r.model.myComment=null}function p(e){r.editCommentMode=!r.editCommentMode,r.editComment=r.editCommentMode?e:void 0}function f(e){r.showReplyInput=!r.showReplyInput,r.targetComment=e}r.model={myComment:null,isLoggedIn:e.AppData.User},r.myReply=null,r.showCommentInput=!1,r.showReplyInput=!1,r.editCommentMode=!1,r.postComment=o.throttle(c,1e3),r.deleteComment=l,r.loadReplies=u,r.showReplies=!1,r.toggleCommentInput=d,r.toggleEditCommentMode=p,r.toggleReplyInput=f,r.$on("reply:complete",function(e,t){r.toggleReplyInput(void 0)})}}}]).directive("critiquesBlock",["$rootScope","DataService","UserActions","$modal","_",function(e,t,n,i,o){return{restrict:"E",templateUrl:"directives/critiques.html",scope:{critiques:"=critiques",disable:"=disable",parentUrlId:"=",parentOwnerId:"="},link:function(r,a,s){r.isLoggedIn=e.AppData.User,r.showQuickReply=Foundation.MediaQuery.atLeast("large"),r.isPrivate=function(e){return e["private"]},r.isOwnerOrAuthor=function(e){return r.isLoggedIn&&(r.isLoggedIn.id==e.user_id||r.isLoggedIn.id==r.parentOwnerId)},r.deleteCritique=function(a){n.checkAuth().then(function(n){if(n){var s=i.open({templateUrl:"common/confirmDialog.html",controller:["$scope","$modalInstance",function(e,t){e.ok=function(){t.close(!0)},e.cancel=function(){t.dismiss("cancel")}}],size:Foundation.MediaQuery.atLeast("large")?"tiny":"small",keyboard:!0});s.result.then(function(){r.isOwnerOrAuthor&&t["delete"]("Critique",a.id).then(function(){e.toastMessage("Your critique was deleted."),self.film.critiques_count--,r.updateVideoObj(),self.checkUserActions(),r.critiques=o.reject(r.critiques,function(e){return e.id===a.id})})},function(){})}})}}}}]).directive("toggleReplies",["$rootScope",function(e){return{restrict:"A",link:function(e,t,n){t.on("click",function(){e.loadReplies(e.comment),e.comment.replies_count&&(jQuery(this).parent().nextAll().slideToggle(),jQuery(this).hasClass("hide-reply")?(jQuery(this).removeClass("hide-reply"),jQuery(this).html('Show replies <i class="fa fa-angle-down"></i>')):(jQuery(this).addClass("hide-reply"),jQuery(this).html('Hide replies <i class="fa fa-angle-up"></i>')))})}}}]).directive("repliesBlock",[function(){return{restrict:"E",replace:!0,templateUrl:"directives/replies.html",link:function(e,t,n){}}}]).directive("replyBlock",["$rootScope","UserActions","DataService","_",function(e,t,n,i){return{restrict:"E",replace:!0,templateUrl:"directives/reply-comment.html",link:function(o,r,a){function s(){if(!e.isAuthenticated())return t.loginModal(),!1;if(e.isNotVerified())return e.toastAction("Please verify your account so you can rate videos! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1;var r=angular.isString(o.targetComment.comment_id)?o.targetComment.comment_id:o.targetComment;angular.isString(r)&&(r=i.findWhere(o.comments.data,{id:o.targetComment.comment_id})),n.save("comments",{body:o.myReply,critique_id:o.parent.id,comment_id:r.id,user_id:o.model.isLoggedIn.id}).then(function(t){if(r.repliesLoaded)var i=!0,a=r.replies||[];r.replies||(r.replies=[]),r.replies.push(t.data.data),r.replies_count++,o.toggleReplyInput(),o.parent.comments_count++,o.parent.hasOwnProperty("unlist")?n.item("projects",o.parent.id).then(function(e){angular.extend(o.parent,e.data.data),i&&(r.repliesLoaded=!0,a.push(t.data.data),r.replies=a)}):n.item("critiques",o.parent.id).then(function(e){
angular.extend(o.parent,e.data.data),i&&(r.repliesLoaded=!0,a.push(t.data.data),r.replies=a)}),e.toastMessage("Reply posted!"),o.myReply=null},function(e){console.log("Failed to create new reply, with error code: "+e.message)})}o.postReply=i.throttle(s,1e3)}}}]).directive("quickReplyBlock",["$rootScope","UserActions","DataService","_",function(e,t,n,i){return{restrict:"E",replace:!0,templateUrl:"directives/reply-comment.html",link:function(o,r,a){function s(){return e.isAuthenticated()?e.isNotVerified()?(e.toastAction("Please verify your account so you can rate videos! Check your spam folder too.","Verify Now",e.requestVerificationEmail()),!1):void n.save("comments",{body:o.myReply,critique_id:o.critique.id,user_id:o.model.isLoggedIn.id}).then(function(t){o.critique.comments_count++,o.myReply=null,o.showQuickReply=!1,e.toastMessage("Quick Reply posted!")},function(e){console.log("Failed to create new reply, with error code: "+e.message)}):(t.loginModal(),!1)}o.model={isLoggedIn:e.AppData.User},o.postReply=i.throttle(s,1e3)}}}]).directive("editCommentBlock",["$rootScope","UserActions","DataService","_",function(e,t,n,i){return{restrict:"E",replace:!0,templateUrl:"directives/edit-comment.html",link:function(e,o,r){function a(){return e.editedBody===e.editComment.body?(e.toggleEditCommentMode(),e.editComment):void t.checkAuth().then(function(t){n.update("comments",e.editComment.id,{body:e.editedBody,editedAt:moment().toDate()}).then(function(t){return e.toggleEditCommentMode(),t.data})})}e.editedBody=e.editComment.body,e.updateComment=i.throttle(a,1e3)}}}]).directive("focusOn",["$timeout",function(e){return{restrict:"A",link:function(t,n,i){t.$watch(i.focusOn,function(t){e(function(){t?n.focus():n.blur()})})}}}]).directive("validateEmail",function(){var e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return{require:"ngModel",restrict:"",link:function(t,n,i,o){o&&o.$validators.email&&(o.$validators.email=function(t){return o.$isEmpty(t)||e.test(t)})}}}).directive("myEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.myEnter)}),t.preventDefault())})}}).directive("datepicker",["$document",function(e){return{require:"ngModel",restrict:"A",scope:{format:"="},link:function(t,n,i,o){var r=/Firefox/i.test(navigator.userAgent),a=e.documentMode||!1;(r||a)&&jQuery(n).fdatepicker({format:t.format||"mm-dd-yyyy"}).on("changeDate",function(e){t.$apply(function(){o.$setViewValue(e.date)})})}}}]).directive("linkify",["$filter","$timeout","linkify",function(e,t,n){return{restrict:"A",link:function(e,i,o){var r=o.linkify||"normal";t(function(){i.html(n[r](i.html()))})}}}]).directive("broadstreetZone",["$window","$sce",function(e,t){return{restrict:"E",templateUrl:"directives/broadstreet-zone.html",transclude:!0,scope:{zone:"=",width:"=",height:"="},link:function(e,n,i){e.link=t.trustAsResourceUrl("https://ad.broadstreetads.com/zdisplay/"+e.zone+".html")}}}]).directive("staticSideBar",["$window","$sce",function(e,t){return{restrict:"E",templateUrl:"directives/static-sidebar.html",transclude:!0,replace:!0}}]),angular.module("IndieWise.filters",[]).filter("truncate",function(){return function(e,t,n){if(angular.isString(e))return isNaN(t)&&(t=10),void 0===n&&(n="..."),e.length<=t||e.length-n.length<=t?e:String(e).substring(0,t-n.length)+n}}).filter("secondsToDateTime",[function(){return function(e){return new Date(1970,0,1).setSeconds(e)}}]).filter("linkify",function(){function e(e,t){if(e){var n=e.replace(/(?:https?\:\/\/|www\.)+(?![^\s]*?")([\w.,@?!^=%&amp;:\/~+#-]*[\w@?!^=%&amp;\/~+#-])?/gi,function(e){var t=document.createElement("div"),n=document.createElement("a");return n.href=e,n.target="_blank",n.innerHTML=e,t.appendChild(n),t.innerHTML});return n?("twitter"===t&&(n=n.replace(/(|\s)*@([\u00C0-\u1FFF\w]+)/g,'$1<a href="https://twitter.com/$2" target="_blank">@$2</a>'),n=n.replace(/(^|\s)*#([\u00C0-\u1FFF\w]+)/g,'$1<a href="https://twitter.com/search?q=%23$2" target="_blank">#$2</a>')),"github"===t&&(n=n.replace(/(|\s)*@(\w+)/g,'$1<a href="https://github.com/$2" target="_blank">@$2</a>')),n):""}}return function(t,n){return e(t,n)}})}(),function(){"use strict";function e(e,t,n,r,a,s,c,l){var u={checkAuth:function(){var e=t.defer();return n.isAuthenticated()?e.resolve(!0):e.reject(!1),e.promise},markAsWatched:function(e){var t=0;return s(function(){r.save("projects/watched",{project_id:e.id})},t)},cancelWatched:function(e){s.cancel(e)},canCritique:function(e){var i=t.defer();return n.isAuthenticated()?r.collection("critiques",{project:e,user:n.currentUser.id}).then(function(e){e.data.data.length?i.reject(e.data.data[0]):i.resolve(!0)}):i.reject(!1),i.promise},canReact:function(e){var i=t.defer();return n.currentUser?r.collection("reactions",{project:e,user:n.currentUser.id}).then(function(e){e.data.data.length?i.reject(e.data.data[0]):i.resolve(!0)}):i.reject(!1),i.promise},canRate:function(e){var i=t.defer();return n.currentUser?r.collection("ratings",{project:e,user:n.currentUser.id}).then(function(e){e.data.ratings.length?i.reject(e.data.ratings[0]):i.resolve(!0)}):i.reject(!1),i.promise},loginModal:function(){if(!e.authModalOpen){var t={controller:i,controllerAs:"SIC",templateUrl:"auth/sign-in-dialog.html",size:Foundation.MediaQuery.atLeast("medium")?"large":"full"},n=c.open(t);n.result.then(function(t){console.log(t),e.authModalOpen=!1,o(!0)},function(){console.log("You cancelled the dialog."),e.authModalOpen=!1,o(!0)}),e.authModalOpen=!0}}};return u}function t(e,t,n,i,o,r,a){function s(){c.getCurrentUser()}var c={createUser:function(e){var t={email:e.email,password:e.password,password_confirmation:e.passwordCheck,username:e.email,firstName:e.firstName,lastName:e.lastName,fullName:e.firstName+" "+e.lastName,country_id:e.country,dob:e.dob,gender:e.gender};return r.signup(t).then(function(t){return c.error="",console.log("User "+t.username+" created successfully!"),c.login(e.email,e.password).then(function(e){console.log(e),c.getCurrentUser().then(function(e){console.log(e),n.go("profile.about")})})})["catch"](function(e){return{status:!1,errors:c.error=e.data.errors||"Unknown error from server"}})},updateUser:function(e){return o.update("users/me",e.id,e).then(function(e){return e})["catch"](function(e){return console.log(e),e})},deleteUser:function(){return o["delete"]("users/me").then(function(e){return e})},requestVerification:function(){return o.collection("request_verification").then(function(e){return e})},currentUser:null,getCurrentUser:function(n){var o=t.defer();return c.isAuthenticated()?angular.isObject(c.currentUser)?o.resolve(c.currentUser):i.get(a+"authenticate").then(function(t){o.resolve(e.AppData.User=c.currentUser=t.data.user)}):o.reject(!1),o.promise},login:function(e,t){return r.login({email:e,password:t}).then(function(e){return 200===e.status?(i.defaults.headers.common.Authorization="Bearer "+e.data.token,r.setToken(e.data.token),c.getCurrentUser(),!0):{status:!1,errors:c.error={credentials:["Invalid email or password"]}}})["catch"](function(e){return console.log(e),{status:!1,errors:c.error=e.data.errors||"Unknown error from server"}})},socialLogin:function(e,t){return t=t||!1,r.authenticate(e).then(function(e){c.getCurrentUser().then(function(e){return self.error="",t?e:void(moment(e.created_at).isSame(moment(),"hour")?(console.log("User "+e.fullName+" created successfully!"),n.go("profile.about")):n.go("home"))})})["catch"](function(e){return{status:!1,errors:c.error=e.data.errors||"Unknown error from server"}})},logout:function(){return i.post(a+"logout",null).then(function(){r.removeToken(),r.logout()})},requestPasswordReset:function(e){return i.post(a+"requestPasswordReset",{email:e}).then(function(e){return console.log(e),e},function(e){return e})},passwordReset:function(e,t,o,r){return i.post(a+"resetPassword",{email:e,password:t,password_confirmation:o,token:r}).then(function(e){return console.log(e),n.go("sign_in"),e},function(e){return e})},parseJwt:function(e){var t=e.split(".")[1],n=t.replace("-","+").replace("_","/");return JSON.parse(atob(n))},isAuthenticated:function(){return r.isAuthenticated()}};return s(),c}function n(e,t){var n=this;return n.collection=function(n,i){var o=angular.extend({per_page:10,page:1},i);return e({method:"GET",url:t+n,params:o})},n.item=function(n,i,o,r){return e({method:"GET",url:t+n+"/"+i,params:{include:o,search:r}})},n.save=function(n,i,o){return e({method:"POST",url:t+n,params:o,data:i})},n.update=function(n,i,o,r){return e({method:"PUT",url:t+n+"/"+i,params:r,data:o})},n["delete"]=function(n,i){return e({method:"DELETE",url:t+n+"/"+i})},n.mail=function(n,i){return e.post(t+n,i)},n.notifyMe=function(t){return e.post("utils/notify-me.php",t)},n}function i(e,t,n,i){o(),e.metadata.title="Sign In";var r=this;r.user={email:"",password:""},r.doLogin=function(e){e=e||!0,r.error=!1,n.login(r.user.email,r.user.password).then(function(e){console.log("Success",e)},function(e){r.error=e,console.log("Failed",e)}).then(function(){r.ok()})},r.authenticate=function(e){r.error=null,n.socialLogin(e,!0).then(function(e){console.log(e),r.ok()})},r.ok=function(){i.close()},r.cancel=function(){i.dismiss("cancel")},t(function(){jQuery(document).foundation(),t(function(){jQuery(document).foundation()},500)},0)}function o(e){var t=jQuery(".flex-video");t&&(e?t.css("z-index",""):t.css("z-index",0))}angular.module("IndieWise.services",[]).factory("FacebookAngularPatch",function(e,t){var n=function(){var n=[].splice.call(arguments,0),i=e.defer(),o=t;return window.fbPromise.then(function(){n.push(function(e){return ___.isUndefined(e.error)?void o(function(){i.resolve(e)}):void o(function(){i.reject(e.error)})}),FB.api.apply(FB,n)}),i.promise};window.FB.init({appId:"150687055270744",status:!0,cookie:!0,xfbml:!0,version:"v2.4"}),window.fbPromise.then(function(){FB.apiAngular=n})}).factory("AuthService",t).factory("UserActions",e).factory("DataService",n).factory("socket",["$rootScope","$window",function(e,t){var n=io(t.location.origin,{secure:!0,reconnect:!0,"reconnection delay":500,"max reconnection attempts":10});return{on:function(t,i){n.on(t,function(){var t=arguments;e.$apply(function(){i.apply(n,t)})})},emit:function(t,i,o){n.emit(t,i,function(){var t=arguments;e.$apply(function(){o&&o.apply(n,t)})})}}}]).factory("linkify",["$filter",function(e){function t(t){return function(n){return e("linkify")(n,t)}}return{twitter:t("twitter"),github:t("github"),normal:t()}}]).service("anchorSmoothScroll",function(){this.scrollTo=function(e){function t(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function n(e){for(var t=document.getElementById(e),n=t.offsetTop,i=t;i.offsetParent&&i.offsetParent!=document.body;)i=i.offsetParent,n+=i.offsetTop;return n}var i=t(),o=n(e),r=o>i?o-i:i-o;if(r<100)return void scrollTo(0,o);var a=Math.round(r/100);a>=20&&(a=20);var s=Math.round(r/25),c=o>i?i+s:i-s,l=0;if(o>i)for(var u=i;u<o;u+=s)setTimeout("window.scrollTo(0, "+c+")",l*a),c+=s,c>o&&(c=o),l++;else for(var u=i;u>o;u-=s)setTimeout("window.scrollTo(0, "+c+")",l*a),c-=s,c<o&&(c=o),l++}}),e.$inject=["$rootScope","$q","AuthService","DataService","UtilsService","$timeout","$modal","$mdMedia"],t.$inject=["$rootScope","$q","$state","$http","DataService","$auth","API"],n.$inject=["$http","API"],i.$inject=["$rootScope","$timeout","AuthService","$modalInstance"]}(),angular.module("IndieWise.utilities",[]).factory("UtilsService",["$rootScope","$window","DataService",function(e,t,n){"use strict";return{compressArray:function(e){for(var t=[],n=e.slice(0),i=0;i<e.length;i++){for(var o=0,r=0;r<n.length;r++)e[i]==n[r]&&(o++,delete n[r]);if(o>0){var a=new Object;a.value=e[i],a.count=o,t.push(a)}}return t},parseJwt:function(e){var n=e.split(".")[1],i=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(i))}}}]),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var i=n.indexOf(e,t);return i!==-1&&i===t}),String.prototype.reverse=function(){return this.split("").reverse().join("")};