(function(){"use strict";angular.module("IndieWise.directives",[]).directive("layerSlider",["$rootScope","$timeout","DataService",function($rootScope,$timeout,DataService){return{restrict:"E",transclude:true,templateUrl:"./src/directives/layerSlider.html",scope:{},link:function(scope,el,attrs){DataService.query("countUsers").then(function(res){scope.users=res.data[0].users}).then(function(){$timeout(function(){jQuery("#layerslider").layerSlider({responsive:false,responsiveUnder:1280,layersContainer:1280,skin:"noskin",hoverPrevNext:false,skinsPath:"./assets/layerslider/skins/"})},0)})}}}]).directive("premiumCarousel",["$rootScope","$state","$timeout","DataService",function($rootScope,$state,$timeout,DataService){return{restrict:"E",replace:true,templateUrl:"./src/directives/featured-area.html",scope:{},link:function(scope,el,attrs){DataService.getList("Project",null,[{fieldName:"unlist",operator:"is",value:false}],12,true,true,1).then(function(result){scope.featuredFilms=result.data}).then(function(){$timeout(function(){jQuery(".owl-carousel").each(function(){var owl=jQuery(this);jQuery(".prev").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("prev.owl.carousel")});jQuery(".next").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("next.owl.carousel")});var loopLength=owl.data("car-length");var divLength=jQuery(this).find("div.item").length;if(divLength>loopLength){owl.owlCarousel({dots:owl.data("dots"),items:owl.data("items"),slideBy:owl.data("slideby"),center:owl.data("center"),loop:owl.data("loop"),margin:owl.data("margin"),nav:owl.data("nav"),autoplay:owl.data("autoplay"),autoplayTimeout:owl.data("autoplay-timeout"),autoWidth:owl.data("auto-width"),autoHeight:owl.data("auto-Height"),merge:owl.data("merge"),responsive:{0:{items:owl.data("responsive-small"),nav:false},600:{items:owl.data("responsive-medium"),nav:false},1e3:{items:owl.data("responsive-large"),nav:false},1900:{items:owl.data("responsive-xlarge"),nav:false}}})}else{owl.owlCarousel({dots:false,items:owl.data("items"),loop:false,margin:owl.data("margin"),autoplay:false,autoplayHoverPause:true,responsiveClass:true,autoWidth:owl.data("auto-width"),autoHeight:owl.data("auto-Height")})}})},1e3)})}}}]).directive("watchingCarousel",["$rootScope","$timeout","$interval","DataService",function($rootScope,$timeout,$interval,DataService){return{restrict:"E",replace:true,templateUrl:"./src/directives/people-watching.html",scope:{},link:function(scope,el,attrs){scope.getWatchedList=function(){DataService.getList("Watched",[{fieldName:"updatedAt",order:"desc"}],[{fieldName:"count",operator:"greaterThan",value:0}],7,true,true,1).then(function(result){scope.watched=result.data;$timeout(function(){jQuery(".owl-carousel").each(function(){var owl=jQuery(this);jQuery(".prev").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("prev.owl.carousel")});jQuery(".next").on("click",function(){jQuery(this).parent().parent().parent().parent().next().trigger("next.owl.carousel")});var loopLength=owl.data("car-length");var divLength=jQuery(this).find("div.item").length;if(divLength>loopLength){owl.owlCarousel({dots:owl.data("dots"),items:owl.data("items"),slideBy:owl.data("slideby"),center:owl.data("center"),loop:owl.data("loop"),margin:owl.data("margin"),nav:owl.data("nav"),autoplay:owl.data("autoplay"),autoplayTimeout:owl.data("autoplay-timeout"),autoWidth:owl.data("auto-width"),autoHeight:owl.data("auto-Height"),merge:owl.data("merge"),responsive:{0:{items:owl.data("responsive-small"),nav:false},600:{items:owl.data("responsive-medium"),nav:false},1e3:{items:owl.data("responsive-large"),nav:false},1900:{items:owl.data("responsive-xlarge"),nav:false}}})}else{owl.owlCarousel({dots:false,items:owl.data("items"),loop:false,margin:owl.data("margin"),autoplay:false,autoplayHoverPause:true,responsiveClass:true,autoWidth:owl.data("auto-width"),autoHeight:owl.data("auto-Height")})}})},0)})};scope.getWatchedList()}}}]).directive("playlists",["$rootScope","DataService","UserActions","_",function($rootScope,DataService,UserActions,_){return{restrict:"E",templateUrl:"./src/directives/playlists.html",replace:false,scope:{project:"="},link:function(scope,el,attrs){scope.model={newName:null,playlistArr:[]};scope.newPlInput=false;if($rootScope.AppData.User){DataService.getList("Playlist",[],[{fieldName:"user",operator:"in",value:$rootScope.AppData.User.userId}],10,true,false).then(function(res){DataService.query("checkInPlaylist",{id:scope.project.id}).then(function(resA){scope.model.playlistArr=resA.data;scope.playlists=res.data})})}scope.toggleNewPlInput=function(clear){scope.newPlInput=!scope.newPlInput;if(clear){scope.model.newName=null}};scope.newPlaylist=function(){UserActions.checkAuth().then(function(res){DataService.save("Playlist",{name:scope.model.newName,user:$rootScope.AppData.User.userId},false,true).then(function(pl){scope.toggleNewPlInput(false);scope.model.newName=null;scope.playlists.push(pl.data)})},function(err){UserActions.loginModal().then(function(res){debugger})})};scope.syncPlaylists=function(bool,item){if(bool){scope.model.playlistArr.push(item);DataService.save("PlaylistItem",{playlist:item.id,project:scope.project.id});$rootScope.toastMessage("Added to playlist")}else{for(var i=0;i<scope.model.playlistArr.length;i++){if(scope.model.playlistArr[i].id==item.id){var genreSetting=_.findWhere(scope.model.playlistArr,{project:scope.project.id,playlist:item.id});if(genreSetting){DataService.delete("PlaylistItem",genreSetting.id)}scope.model.playlistArr.splice(i,1);$rootScope.toastMessage("Removed from playlist")}}}};scope.isCheckedPlaylist=function(id){var match=false;for(var i=0;i<scope.model.playlistArr.length;i++){if(scope.model.playlistArr[i].playlist==id){match=true}}return match}}}}]).directive("toggleShowMore",["$rootScope","$timeout",function($rootScope,$timeout){return{restrict:"A",scope:{showMoreHeight:"=showMoreHeight"},link:function(scope,el,attrs){$timeout(function(){el.showMore({speedDown:300,speedUp:300,height:scope.showMoreHeight?scope.showMoreHeight+"px":"165px",showText:"Show more",hideText:"Show less"})},500)}}}]).directive("elitePlayer",["$rootScope","DataService","UserActions","$timeout","$interval","anchorSmoothScroll","_",function($rootScope,DataService,UserActions,$timeout,$interval,anchorSmoothScroll,_){return{restrict:"E",templateUrl:"./src/directives/videoPlayer.html",scope:{film:"=film",type:"=type",lightsOff:"=lightsOff"},link:function(scope,el,attrs){var listenerStarted=false;var hasWatched=false;var playlist=[];var video=scope.film;playlist.push({videoType:scope.type,title:video.name,youtubeID:scope.type==="youtube"?video.video_url.indexOf("v=")!=-1?video.video_url.split("v=")[1].split("&")[0]:video.video_url.split("be/")[1]:"",vimeoID:scope.type==="vimeo"?video.video_url.split(".com/")[1]:"",mp4:scope.type==="hosted"?video.video_url:"",imageUrl:video.thumbnail_url,imageTimer:4,prerollAD:"no",prerollGotoLink:"http://getindiewise.com/",preroll_mp4:"http://creativeinteractivemedia.com/player/videos/Short_Elegant_Logo_Reveal.mp4",prerollSkipTimer:5,midrollAD:"no",midrollAD_displayTime:"00:10",midrollGotoLink:"http://getindiewise.com/",midroll_mp4:"http://creativeinteractivemedia.com/player/videos/Logo_Explode.mp4",midrollSkipTimer:5,postrollAD:"no",postrollGotoLink:"http://getindiewise.com/",postroll_mp4:"http://creativeinteractivemedia.com/player/videos/Logo_Light.mp4",postrollSkipTimer:5,popupImg:"images/preview_images/popup.jpg",popupAdShow:"no",popupAdStartTime:"00:03",popupAdEndTime:"00:07",popupAdGoToLink:"http://getindiewise.com/",description:video.description,thumbImg:video.thumbnail_url,info:""});DataService.getList("Project",null,[{fieldName:"owner",operator:"in",value:angular.isString(video.owner)?video.owner:video.owner.id},{fieldName:"id",operator:"notEquals",value:video.id}],10,true,true,1).then(function(result){scope.playlistFilms=result.data.data;return scope.playlistFilms}).then(function(res){_.each(res,function(vid){var type="";if(vid.video_url.indexOf("youtu")!=-1){type="youtube"}else if(vid.video_url.indexOf("vimeo")!=-1){type="vimeo"}else{type="other"}playlist.push({videoType:type,title:vid.name,youtubeID:type==="youtube"?vid.video_url.indexOf("v=")!=-1?vid.video_url.split("v=")[1].split("&")[0]:vid.video_url.split("be/")[1]:"",vimeoID:type==="vimeo"?vid.video_url.split(".com/")[1]:"",mp4:type==="hosted"?vid.video_url:"",prerollAD:"no",prerollGotoLink:"http://getindiewise.com/",preroll_mp4:"http://creativeinteractivemedia.com/player/videos/Short_Elegant_Logo_Reveal.mp4",prerollSkipTimer:5,midrollAD:"no",midrollAD_displayTime:"00:10",midrollGotoLink:"http://getindiewise.com/",midroll_mp4:"http://creativeinteractivemedia.com/player/videos/Logo_Explode.mp4",midrollSkipTimer:5,postrollAD:"no",postrollGotoLink:"http://getindiewise.com/",postroll_mp4:"http://creativeinteractivemedia.com/player/videos/Logo_Light.mp4",postrollSkipTimer:5,popupImg:"images/preview_images/popup.jpg",popupAdShow:"no",popupAdStartTime:"00:03",popupAdEndTime:"00:07",popupAdGoToLink:"http://getindiewise.com/",description:vid.description,thumbImg:vid.thumbnail_url,info:""})})}).finally(function(){window.videoPlayer=scope.videoPlayer=el.Video({instanceName:"player1",autohideControls:2,hideControlsOnMouseOut:"No",videoPlayerWidth:"100%",videoPlayerHeight:Foundation.MediaQuery.atLeast("large")?470:420,responsive:true,playlist:"Right playlist",playlistScrollType:"light",playlistBehaviourOnPageload:"closed",autoplay:false,colorAccent:"#3F51B5",vimeoColor:"00adef",youtubeControls:"custom controls",youtubeSkin:"dark",youtubeColor:"red",youtubeQuality:"default",youtubeShowRelatedVideos:"No",videoPlayerShadow:"effect2",loadRandomVideoOnStart:"No",shuffle:"No",posterImg:video.thumbnail_url,onFinish:"Stop video",nowPlayingText:"Yes",fullscreen:"Fullscreen native",rightClickMenu:false,hideVideoSource:true,showAllControls:true,allowSkipAd:true,infoShow:"No",shareShow:"No",facebookShow:"No",twitterShow:"No",mailShow:"No",facebookShareName:video.name,facebookShareLink:window.location.href,facebookShareDescription:video.description,facebookSharePicture:video.thumbnail_url,twitterText:video.name,twitterLink:window.location.href,twitterHashtags:"indiewise",twitterVia:"IndieWise",googlePlus:window.location.href,logoShow:"Yes",logoClickable:"Yes",logoPath:"./assets/img/Logo_alt2_web_87x45.png",logoGoToLink:"http://getindiewise.com",logoPosition:"bottom-left",embedShow:"No",embedCodeSrc:"www.yourwebsite.com/videoplayer/index.html",embedCodeW:"746",embedCodeH:"420",embedShareLink:window.location.href,youtubePlaylistID:"",youtubeChannelID:"",videos:playlist});startedPlaying()});var startedPlaying=$interval(function(){if(scope.videoPlayer.state==="loading"&&!!angular.element("#elite_vp_vimeoWrapper iframe")){if(!listenerStarted){if(window.addEventListener){window.addEventListener("message",vimeoListener,false)}else{window.attachEvent("onmessage",vimeoListener)}listenerStarted=true}}if(scope.videoPlayer.state==="elite_vp_playing"){toggleLights();$rootScope.initWatch();switch(scope.type){case"youtube":scope.videoPlayer.youtubePlayer.addEventListener("onStateChange",function(a){if(a.target.getPlayerState()==0){toggleLights();anchorSmoothScroll.scrollTo("SinglePostStats")}});break}$interval.cancel(startedPlaying)}},1e3);function vimeoListener(event){if(!/^https?:\/\/player.vimeo.com/.test(event.origin)){return false}var data=JSON.parse(event.data);if(data.event==="playProgress"){if(!hasWatched){toggleLights();$rootScope.initWatch();hasWatched=true;$interval.cancel(startedPlaying)}if(window.addEventListener){window.removeEventListener("message",vimeoListener,false)}else{window.detachEvent("onmessage",vimeoListener)}}}function toggleLights(){scope.lightsOff=!scope.lightsOff;var overlay=jQuery("#overlay");overlay.fadeToggle(1e3);if(!scope.lightsOff){$timeout(function(){overlay.removeClass("highlight")},1e3)}else{overlay.addClass("highlight")}}jQuery("#overlay").on("click",function(){toggleLights()})}}}]).directive("sideNavNotif",["$mdSidenav",function($mdSidenav){return{restrict:"A",link:function(scope,el,attrs){el.find("a").bind("click",function(){$mdSidenav("right").close()})}}}]).directive("helpInfo",[function(){return{restrict:"E",transclude:true,templateUrl:"./src/directives/help-info.html",scope:{text:"=text",direction:"=direction"}}}]).directive("projectCard",["$rootScope","$state","$modal","$mdMedia","UserActions",function($rootScope,$state,$modal,$mdMedia,UserActions){return{restrict:"E",transclude:true,templateUrl:"./src/directives/project-card.html",scope:{video:"=video",type:"=type",related:"=related",queried:"=queried"},link:function(scope,el,attrs){scope.isQueried=scope.queried==="true";scope.isOpenFab=false;scope.isLoggedIn=$rootScope.AppData.User;scope.openShareDialog=openShareDialog;scope.toFavorites=toFavorites;scope.toWatchLater=toWatchLater;scope.check=check;function check(obj){UserActions.checkAuth().then(function(res){UserActions.checkFavorite(obj).then(function(res){scope.isFaved=true},function(res){scope.isFaved=res});UserActions.checkWatchLater(obj).then(function(res){scope.isSaved=true},function(res){scope.isSaved=res})},function(err){UserActions.loginModal().then(function(res){debugger})})}function toFavorites(obj){return UserActions.favorite(obj)}function toWatchLater(obj){return UserActions.watchLater(obj)}function openShareDialog(video){$modal.open({templateUrl:"./src/common/shareDialog.html",resolve:{Video:function(){return video}},controller:["$scope","$modalInstance","Video",function($scope,$modalInstance,Video){$scope.video=Video;$scope.shareLink=window.location.origin+"/alpha/"+Video.url_id;$scope.cancel=function(){$modalInstance.cancel()}}]})}scope.deleteProject=function(ev){if($rootScope.isLoggedIn&&$rootScope.isLoggedIn.id===scope.video.owner.id){var confirm=$modal.confirm().title("Would you like to delete your project?").targetEvent(ev).ok("Delete it!").cancel("Never mind");$modal.show(confirm).then(function(){self.project.destroy({success:function(myObject){$state.go("profile")},error:function(myObject,error){}});$state.go("profile")},function(){})}}}}}]).directive("commentsBlock",["$rootScope","DataService","UserActions","UtilsService","$modal","_",function($rootScope,DataService,UserActions,UtilsService,$modal,_){return{restrict:"E",templateUrl:"./src/directives/comments.html",scope:{comments:"=comments",disable:"=disable",parent:"=parent"},link:function(scope,el,attrs){scope.model={myComment:null,isLoggedIn:$rootScope.AppData.User,isLoggedInData:$rootScope.AppData.UserData};scope.myReply=null;scope.showCommentInput=false;scope.showReplyInput=false;scope.editCommentMode=false;scope.postComment=_.throttle(postComment,1e3);scope.deleteComment=deleteComment;scope.loadReplies=loadReplies;scope.showReplies=false;scope.toggleCommentInput=toggleCommentInput;scope.toggleEditCommentMode=toggleEditCommentMode;scope.toggleReplyInput=toggleReplyInput;function postComment(){UserActions.checkAuth().then(function(res){if(res){DataService.save("Comment",{body:scope.model.myComment,parentFilm:scope.parent.hasOwnProperty("unlist")?scope.parent.id:undefined,parentCritique:!scope.parent.hasOwnProperty("unlist")?scope.parent.id:undefined,author:scope.model.isLoggedIn.userId},true,true).then(function(comment){angular.extend(comment.data,{ownerId:comment.data.author.id,ownerUrlId:comment.data.author.url_id,ownerFullName:comment.data.author.firstName+" "+comment.data.author.lastName,ownerAvatar:comment.data.author.avatar});scope.comments.data.push(comment.data);$rootScope.toastMessage("Comment posted!");scope.model.myComment=null;clearCommentinput();scope.parent.commentCount++;DataService.query("getCritiqueByUrlId",{urlId:scope.parent.url_id}).then(function(result){scope.parent=result.data[0]});UtilsService.recordActivity(comment.data,"comment")},function(error){console.log("Failed to create new comment, with error code: "+error.message)})}})}function deleteComment(c,ev){UserActions.checkAuth().then(function(res){if(res){var confirm=$modal.confirm().title("Would you like to delete your comment?").targetEvent(ev).ok("Delete").cancel("Cancel");$modal.show(confirm).then(function(){var p=c.parentComment||undefined;DataService.delete("Comment",c.id).then(function(res){scope.parent.commentCount--;UtilsService.deleteActivity(c);if(angular.isUndefined(p)){scope.comments=_.reject(scope.comments,function(a){return a.id===c.id})}else{var z=_.find(scope.comments,function(a){return a.id===p.id});z.replies=_.reject(z.replies,function(a){return a.id===c.id});var pcQuery=new Parse.Query("Comment");pcQuery.get(p.id).then(function(res){res.increment("replyCount",-1);res.save()});return c=undefined}$rootScope.toastMessage("Your comment was deleted.")})},function(){})}})}function loadReplies(comment){if(!comment.repliesLoaded){DataService.query("getCommentReplies",{id:comment.id}).then(function(replies){comment.replies=replies.data;comment.repliesLoaded=true;comment.showReplies=!comment.showReplies;return comment})}else{comment.showReplies=!comment.showReplies;return comment}}function toggleCommentInput(){scope.showCommentInput=!scope.showCommentInput}function clearCommentinput(){scope.model.myComment=null}function toggleEditCommentMode(comment){scope.editCommentMode=!scope.editCommentMode;scope.editComment=!!scope.editCommentMode?comment:undefined}function toggleReplyInput(comment){scope.showReplyInput=!scope.showReplyInput;scope.targetComment=comment}scope.$on("reply:complete",function(event,comment){scope.toggleReplyInput(undefined)})}}}]).directive("critiquesBlock",["$rootScope","DataService","UserActions","UtilsService","$modal",function($rootScope,DataService,UserActions,UtilsService,$modal){return{restrict:"E",templateUrl:"./src/directives/critiques.html",scope:{critiques:"=critiques",disable:"=disable",parentUrlId:"="},link:function(scope,el,attrs){scope.isLoggedIn=$rootScope.AppData.User}}}]).directive("toggleReplies",["$rootScope",function($rootScope){return{restrict:"A",link:function(scope,el,attrs){if(scope.comment.replyCount){el.html('Show replies <i class="fa fa-angle-down"></i>')}el.on("click",function(){scope.loadReplies(scope.comment);if(scope.comment.replyCount){jQuery(this).parent().nextAll().slideToggle();if(jQuery(this).hasClass("hide-reply")){jQuery(this).removeClass("hide-reply");jQuery(this).html('Show replies <i class="fa fa-angle-down"></i>')}else{jQuery(this).addClass("hide-reply");jQuery(this).html('Hide replies <i class="fa fa-angle-up"></i>')}}})}}}]).directive("repliesBlock",[function(){return{restrict:"E",replace:true,templateUrl:"./src/directives/replies.html",link:function(scope,el,attrs){}}}]).directive("replyBlock",["$rootScope","UserActions","DataService","UtilsService","_",function($rootScope,UserActions,DataService,UtilsService,_){return{restrict:"E",replace:true,templateUrl:"./src/directives/reply-comment.html",link:function(scope,el,attrs){scope.postReply=_.throttle(postReply,1e3);function postReply(){UserActions.checkAuth().then(function(res){if(res){var repliedTo=angular.isObject(scope.targetComment.parentComment)?scope.targetComment.parentComment:scope.targetComment;DataService.save("Comment",{body:scope.myReply,parentCritique:scope.parent.id,parentComment:repliedTo.id,author:scope.model.isLoggedIn.userId},true,true).then(function(comment){if(!!repliedTo.repliesLoaded){var repliesLoaded=true;var oldReplies=repliedTo.replies||[]}if(!repliedTo.replies){repliedTo.replies=[]}angular.extend(comment.data,{ownerId:comment.data.author.id,ownerUrlId:comment.data.author.url_id,ownerFullName:comment.data.author.firstName+" "+comment.data.author.lastName,ownerAvatar:comment.data.author.avatar});repliedTo.replies.push(comment.data);scope.toggleReplyInput();scope.parent.commentCount++;if(scope.parent.hasOwnProperty("unlist")){DataService.getItem("Project",scope.parent.id,true,"",2).then(function(a){scope.parent=a.data;if(repliesLoaded){repliedTo.repliesLoaded=true;oldReplies.push(comment);repliedTo.replies=oldReplies}})}else{DataService.getItem("Critique",scope.parent.id,true,"",2).then(function(a){scope.parent=a.data;if(repliesLoaded){repliedTo.repliesLoaded=true;oldReplies.push(comment);repliedTo.replies=oldReplies}})}$rootScope.toastMessage("Reply posted!");scope.myReply=null;UtilsService.recordActivity(comment.data,"reply")},function(error){console.log("Failed to create new reply, with error code: "+error.message)})}})}}}}]).directive("editCommentBlock",["$rootScope","UserActions","DataService","UtilsService","_",function($rootScope,UserActions,DataService,UtilsService,_){return{restrict:"E",replace:true,templateUrl:"./src/directives/edit-comment.html",link:function(scope,el,attrs){scope.editedBody=scope.editComment.body;scope.updateComment=_.throttle(updateComment,1e3);function updateComment(){if(scope.editedBody===scope.editComment.body){scope.toggleEditCommentMode();return scope.editComment}UserActions.checkAuth().then(function(res){DataService.update("Comment",scope.editComment.id,{body:scope.editedBody,editedAt:moment().toDate()}).then(function(comment){scope.toggleEditCommentMode();return comment.data})})}}}}]).directive("focusOn",["$timeout",function($timeout){return{restrict:"A",link:function($scope,$element,$attr){$scope.$watch($attr.focusOn,function(_focusVal){$timeout(function(){_focusVal?$element.focus():$element.blur()})})}}}]).directive("validateEmail",function(){var EMAIL_REGEXP=/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,5})$/;return{require:"ngModel",restrict:"",link:function(scope,elm,attrs,ctrl){if(ctrl&&ctrl.$validators.email){ctrl.$validators.email=function(modelValue){return ctrl.$isEmpty(modelValue)||EMAIL_REGEXP.test(modelValue)}}}}}).directive("myEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){if(event.which===13){scope.$apply(function(){scope.$eval(attrs.myEnter)});event.preventDefault()}})}});angular.module("IndieWise.filters",[]).filter("truncate",function(){return function(text,length,end){if(angular.isString(text)){if(isNaN(length))length=10;if(end===undefined)end="...";if(text.length<=length||text.length-end.length<=length){return text}else{return String(text).substring(0,length-end.length)+end}}}}).filter("secondsToDateTime",[function(){return function(seconds){return new Date(1970,0,1).setSeconds(seconds)}}]).filter("linkify",function(){function linkify(_str,type){if(!_str){return}var _text=_str.replace(/(?:https?\:\/\/|www\.)+(?![^\s]*?")([\w.,@?!^=%&amp;:\/~+#-]*[\w@?!^=%&amp;\/~+#-])?/gi,function(url){var wrap=document.createElement("div");var anch=document.createElement("a");anch.href=url;anch.target="_blank";anch.innerHTML=url;wrap.appendChild(anch);return wrap.innerHTML});if(!_text){return""}if(type==="twitter"){_text=_text.replace(/(|\s)*@([\u00C0-\u1FFF\w]+)/g,'$1<a href="https://twitter.com/$2" target="_blank">@$2</a>');_text=_text.replace(/(^|\s)*#([\u00C0-\u1FFF\w]+)/g,'$1<a href="https://twitter.com/search?q=%23$2" target="_blank">#$2</a>')}if(type==="github"){_text=_text.replace(/(|\s)*@(\w+)/g,'$1<a href="https://github.com/$2" target="_blank">@$2</a>')}return _text}return function(text,type){return linkify(text,type)}}).directive("linkify",["$filter","$timeout","linkify",function($filter,$timeout,linkify){return{restrict:"A",link:function(scope,element,attrs){var type=attrs.linkify||"normal";$timeout(function(){element.html(linkify[type](element.html()))})}}}])})();